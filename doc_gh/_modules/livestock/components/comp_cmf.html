
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>livestock.components.comp_cmf &#8212; Livestock_GH .0 documentation</title>
    <link rel="stylesheet" href="../../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
   
  <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for livestock.components.comp_cmf</h1><div class="highlight"><pre>
<span></span><span class="n">__author__</span> <span class="o">=</span> <span class="s2">&quot;Christian Kongsgaard&quot;</span>
<span class="n">__license__</span> <span class="o">=</span> <span class="s2">&quot;MIT&quot;</span>
<span class="n">__version__</span> <span class="o">=</span> <span class="s2">&quot;0.1.0&quot;</span>

<span class="c1"># -------------------------------------------------------------------------------------------------------------------- #</span>
<span class="c1"># Imports</span>

<span class="c1"># Module imports</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">xml.etree.ElementTree</span> <span class="k">as</span> <span class="nn">ET</span>
<span class="kn">import</span> <span class="nn">collections</span>
<span class="kn">import</span> <span class="nn">subprocess</span>
<span class="kn">from</span> <span class="nn">shutil</span> <span class="k">import</span> <span class="n">copyfile</span>
<span class="kn">import</span> <span class="nn">pprint</span>

<span class="c1"># Livestock imports</span>
<span class="kn">import</span> <span class="nn">livestock.lib.ssh</span> <span class="k">as</span> <span class="nn">ssh</span>
<span class="kn">import</span> <span class="nn">livestock.lib.geometry</span> <span class="k">as</span> <span class="nn">gh_geo</span>
<span class="kn">import</span> <span class="nn">livestock.lib.livestock_csv</span> <span class="k">as</span> <span class="nn">csv</span>
<span class="kn">from</span> <span class="nn">livestock.components.component</span> <span class="k">import</span> <span class="n">GHComponent</span>
<span class="kn">import</span> <span class="nn">livestock.lib.misc</span> <span class="k">as</span> <span class="nn">gh_misc</span>
<span class="kn">from</span> <span class="nn">livestock.lib.templates</span> <span class="k">import</span> <span class="n">pick_template</span>

<span class="c1"># Grasshopper imports</span>
<span class="kn">import</span> <span class="nn">Rhino.Geometry</span> <span class="k">as</span> <span class="nn">rg</span>
<span class="kn">import</span> <span class="nn">rhinoscriptsyntax</span> <span class="k">as</span> <span class="nn">rs</span>

<span class="c1"># -------------------------------------------------------------------------------------------------------------------- #</span>
<span class="c1"># Classes</span>


<div class="viewcode-block" id="CMFGround"><a class="viewcode-back" href="../../../cmf.html#livestock.components.comp_cmf.CMFGround">[docs]</a><span class="k">class</span> <span class="nc">CMFGround</span><span class="p">(</span><span class="n">GHComponent</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ghenv</span><span class="p">):</span>
        <span class="n">GHComponent</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ghenv</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">inputs</span><span class="p">():</span>
            <span class="k">return</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Layers&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;Soil layers to add to the mesh in m&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;access&#39;</span><span class="p">:</span> <span class="s1">&#39;list&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;default_value&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">},</span>

                    <span class="mi">1</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;RetentionCurve&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;Livestock CMF Retention Curve&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;access&#39;</span><span class="p">:</span> <span class="s1">&#39;item&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;default_value&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">},</span>

                    <span class="mi">2</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;VegetationProperties&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;Input from Livestock CMF Vegetation Properties&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;access&#39;</span><span class="p">:</span> <span class="s1">&#39;item&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;default_value&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">},</span>

                    <span class="mi">3</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;SaturatedDepth&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;Initial saturated depth in m. It is depth where the groundwater is located&#39;</span>
                                       <span class="s1">&#39; - Default is set to 3m&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;access&#39;</span><span class="p">:</span> <span class="s1">&#39;item&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;default_value&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">},</span>

                    <span class="mi">4</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;SurfaceWaterVolume&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;Initial surface water volume in m3.&#39;</span>
                                       <span class="s1">&#39; - Default is set to 0 m3&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;access&#39;</span><span class="p">:</span> <span class="s1">&#39;item&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;default_value&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">},</span>

                    <span class="mi">5</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;FaceIndices&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;List of face indices, on where the ground properties are applied.&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;access&#39;</span><span class="p">:</span> <span class="s1">&#39;list&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;default_value&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">},</span>

                    <span class="mi">6</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;ETMethod&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;Set method to calculate evapotranspiration.</span><span class="se">\n</span><span class="s1">&#39;</span>
                                       <span class="s1">&#39;0: No evapotranspiration</span><span class="se">\n</span><span class="s1">&#39;</span>
                                       <span class="s1">&#39;1: Penman-Monteith</span><span class="se">\n</span><span class="s1">&#39;</span>
                                       <span class="s1">&#39;2: Shuttleworth-Wallace</span><span class="se">\n</span><span class="s1">&#39;</span>
                                       <span class="s1">&#39;Default is set to Shuttleworth-Wallace&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;access&#39;</span><span class="p">:</span> <span class="s1">&#39;item&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;default_value&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">},</span>

                    <span class="mi">7</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Manning&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;Set Manning roughness. &#39;</span>
                                       <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">If not set CMF calculates it from the above given values.&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;access&#39;</span><span class="p">:</span> <span class="s1">&#39;item&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;default_value&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">},</span>

                    <span class="mi">8</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;PuddleDepth&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;Set puddle depth. Puddle depth is the height were run-off begins.</span><span class="se">\n</span><span class="s1"> &#39;</span>
                                       <span class="s1">&#39;Default is set to 0.01m&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;access&#39;</span><span class="p">:</span> <span class="s1">&#39;item&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;default_value&#39;</span><span class="p">:</span> <span class="mf">0.01</span><span class="p">},</span>

                    <span class="mi">9</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;SurfaceRunOffMethod&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;Set the method for computing the surface run-off.</span><span class="se">\n</span><span class="s1">&#39;</span>
                                       <span class="s1">&#39;0 - Kinematic Wave.</span><span class="se">\n</span><span class="s1">&#39;</span>
                                       <span class="s1">&#39;1 - Diffusive Wave.</span><span class="se">\n</span><span class="s1">&#39;</span>
                                       <span class="s1">&#39;Default is set 0 - Kinematic Wave.&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;access&#39;</span><span class="p">:</span> <span class="s1">&#39;item&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;default_value&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">}</span>
                    <span class="p">}</span>

        <span class="k">def</span> <span class="nf">outputs</span><span class="p">():</span>
            <span class="k">return</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;readMe!&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;In case of any errors, it will be shown here.&#39;</span><span class="p">},</span>

                    <span class="mi">1</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Ground&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;Livestock Ground Data Class&#39;</span><span class="p">}}</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">inputs</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">outputs</span> <span class="o">=</span> <span class="n">outputs</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">component_number</span> <span class="o">=</span> <span class="mi">11</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;Generates CMF ground&#39;</span> \
                           <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Icon art based created by Ben Davis from the Noun Project.&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">face_indices</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">layers</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">retention_curve</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vegetation_properties</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">saturated_depth</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">surface_water</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">et_number</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">manning</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">puddle</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">surface_run_off_method</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">checks</span> <span class="o">=</span> <span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">results</span> <span class="o">=</span> <span class="kc">None</span>

<div class="viewcode-block" id="CMFGround.check_inputs"><a class="viewcode-back" href="../../../cmf.html#livestock.components.comp_cmf.CMFGround.check_inputs">[docs]</a>    <span class="k">def</span> <span class="nf">check_inputs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Checks inputs and raises a warning if an input is not the correct type.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">checks</span> <span class="o">=</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="CMFGround.config"><a class="viewcode-back" href="../../../cmf.html#livestock.components.comp_cmf.CMFGround.config">[docs]</a>    <span class="k">def</span> <span class="nf">config</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generates the Grasshopper component.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Generate Component</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config_component</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">component_number</span><span class="p">)</span></div>

<div class="viewcode-block" id="CMFGround.run_checks"><a class="viewcode-back" href="../../../cmf.html#livestock.components.comp_cmf.CMFGround.run_checks">[docs]</a>    <span class="k">def</span> <span class="nf">run_checks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">layers</span><span class="p">,</span> <span class="n">retention_curve</span><span class="p">,</span> <span class="n">vegetation_properties</span><span class="p">,</span> <span class="n">saturated_depth</span><span class="p">,</span> <span class="n">surface_water</span><span class="p">,</span> <span class="n">face_indices</span><span class="p">,</span>
                   <span class="n">et_method</span><span class="p">,</span> <span class="n">manning_</span><span class="p">,</span> <span class="n">puddle</span><span class="p">,</span> <span class="n">surface_run_off_method</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gathers the inputs and checks them.</span>
<span class="sd">        :param layers: Depth of layers.</span>
<span class="sd">        :param retention_curve: Livestock retention curve dict.</span>
<span class="sd">        :param vegetation_properties: Livestock vegetation properties dict.</span>
<span class="sd">        :param saturated_depth: Saturated depth of the cell.</span>
<span class="sd">        :param surface_water: Initial surfacee water volume.</span>
<span class="sd">        :param face_indices: Face indices where the properties should be applied to.</span>
<span class="sd">        :param et_method: Evapotranspriation calculation method.</span>
<span class="sd">        :param manning_: Manning roughness.</span>
<span class="sd">        :param puddle: Puddle depth.</span>
<span class="sd">        :param surface_run_off_method: Surface Run-off method.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Gather data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">layers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_default_value</span><span class="p">(</span><span class="n">layers</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">retention_curve</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_default_value</span><span class="p">(</span><span class="n">retention_curve</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vegetation_properties</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_default_value</span><span class="p">(</span><span class="n">vegetation_properties</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">saturated_depth</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_default_value</span><span class="p">(</span><span class="n">saturated_depth</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">surface_water</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_default_value</span><span class="p">(</span><span class="n">surface_water</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">face_indices</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_default_value</span><span class="p">(</span><span class="n">face_indices</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">et_number</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_default_value</span><span class="p">(</span><span class="n">et_method</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">manning</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_default_value</span><span class="p">(</span><span class="n">manning_</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">puddle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_default_value</span><span class="p">(</span><span class="n">puddle</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">surface_run_off_method</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_default_value</span><span class="p">(</span><span class="n">surface_run_off_method</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>

        <span class="c1"># Run checks</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">check_inputs</span><span class="p">()</span></div>

<div class="viewcode-block" id="CMFGround.convert_et_number_to_method"><a class="viewcode-back" href="../../../cmf.html#livestock.components.comp_cmf.CMFGround.convert_et_number_to_method">[docs]</a>    <span class="k">def</span> <span class="nf">convert_et_number_to_method</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Converts a number into a ET method.</span>
<span class="sd">        :return: ET method name.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">et_number</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">et_number</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;penman_monteith&#39;</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">et_number</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;shuttleworth_wallace&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">w</span> <span class="o">=</span> <span class="s1">&#39;ETMethod has to between 0 and 2. Input was: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">et_number</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_warning</span><span class="p">(</span><span class="n">w</span><span class="p">)</span></div>

<div class="viewcode-block" id="CMFGround.convert_runoff_number_to_method"><a class="viewcode-back" href="../../../cmf.html#livestock.components.comp_cmf.CMFGround.convert_runoff_number_to_method">[docs]</a>    <span class="k">def</span> <span class="nf">convert_runoff_number_to_method</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Converts a number into a surface run-off method.</span>
<span class="sd">        :return: Surface run-off name</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">surface_run_off_method</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;kinematic&#39;</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">surface_run_off_method</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;diffusive&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">w</span> <span class="o">=</span> <span class="s1">&#39;SurfaceRunOffMethod has to between 0 and 1. Input was: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">surface_run_off_method</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_warning</span><span class="p">(</span><span class="n">w</span><span class="p">)</span></div>

<div class="viewcode-block" id="CMFGround.run"><a class="viewcode-back" href="../../../cmf.html#livestock.components.comp_cmf.CMFGround.run">[docs]</a>    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        In case all the checks have passed the component runs.</span>
<span class="sd">        The component puts all the inputs into a dict and uses PassClass to pass it on.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">checks</span><span class="p">:</span>
            <span class="n">ground_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;face_indices&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">face_indices</span><span class="p">,</span>
                           <span class="s1">&#39;layers&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">layers</span><span class="p">,</span>
                           <span class="s1">&#39;retention_curve&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">retention_curve</span><span class="p">,</span>
                           <span class="s1">&#39;vegetation_properties&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">vegetation_properties</span><span class="p">,</span>
                           <span class="s1">&#39;saturated_depth&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">saturated_depth</span><span class="p">,</span>
                           <span class="s1">&#39;surface_water_volume&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">surface_water</span><span class="p">,</span>
                           <span class="s1">&#39;et_method&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">convert_et_number_to_method</span><span class="p">(),</span>
                           <span class="s1">&#39;manning&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">manning</span><span class="p">,</span>
                           <span class="s1">&#39;puddle_depth&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">puddle</span><span class="p">,</span>
                           <span class="s1">&#39;runoff_method&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">convert_runoff_number_to_method</span><span class="p">()</span>
                           <span class="p">}</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">results</span> <span class="o">=</span> <span class="n">gh_misc</span><span class="o">.</span><span class="n">PassClass</span><span class="p">(</span><span class="n">ground_dict</span><span class="p">,</span> <span class="s1">&#39;Ground&#39;</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="CMFWeather"><a class="viewcode-back" href="../../../cmf.html#livestock.components.comp_cmf.CMFWeather">[docs]</a><span class="k">class</span> <span class="nc">CMFWeather</span><span class="p">(</span><span class="n">GHComponent</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ghenv</span><span class="p">):</span>
        <span class="n">GHComponent</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ghenv</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">inputs</span><span class="p">():</span>
            <span class="k">return</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Temperature&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;Temperature in C. Either a list or a tree where the number of branches is equal&#39;</span>
                                       <span class="s1">&#39; to the number of mesh faces.&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;access&#39;</span><span class="p">:</span> <span class="s1">&#39;tree&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;default_value&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">},</span>

                    <span class="mi">1</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;WindSpeed&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;Wind speed in m/s. Either a list or a tree where the number of branches is&#39;</span>
                                       <span class="s1">&#39; equal to the number of mesh faces.&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;access&#39;</span><span class="p">:</span> <span class="s1">&#39;tree&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;default_value&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">},</span>

                    <span class="mi">2</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;RelativeHumidity&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;Relative humidity in %. Either a list or a tree where the number of branches is&#39;</span>
                                       <span class="s1">&#39; equal to the number of mesh faces.&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;access&#39;</span><span class="p">:</span> <span class="s1">&#39;tree&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;default_value&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">},</span>

                    <span class="mi">3</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;CloudCover&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;Cloud cover, unitless between 0 and 1. Either a list or a tree where the number&#39;</span>
                                       <span class="s1">&#39; of branches is equal to the number of mesh faces.&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;access&#39;</span><span class="p">:</span> <span class="s1">&#39;tree&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;default_value&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">},</span>

                    <span class="mi">4</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;GlobalRadiation&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;Global Radiation in W/m2. Either a list or a tree where the number of branches&#39;</span>
                                       <span class="s1">&#39; is equal to the number of mesh faces.&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;access&#39;</span><span class="p">:</span> <span class="s1">&#39;tree&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;default_value&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">},</span>

                    <span class="mi">5</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Rain&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;Horizontal precipitation in mm/h. Either a list or a tree where the number of&#39;</span>
                                       <span class="s1">&#39; branches is equal to the number of mesh faces.&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;access&#39;</span><span class="p">:</span> <span class="s1">&#39;tree&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;default_value&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">},</span>

                    <span class="mi">6</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;GroundTemperature&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;Ground temperature in C. Either a list or a tree where the number of branches&#39;</span>
                                       <span class="s1">&#39; is equal to the number of mesh faces.&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;access&#39;</span><span class="p">:</span> <span class="s1">&#39;tree&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;default_value&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">},</span>

                    <span class="mi">7</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Location&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;A Ladybug Tools Location&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;access&#39;</span><span class="p">:</span> <span class="s1">&#39;item&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;default_value&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">},</span>

                    <span class="mi">8</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;MeshFaceCount&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;Number of faces in the ground mesh&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;access&#39;</span><span class="p">:</span> <span class="s1">&#39;item&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;default_value&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">}}</span>

        <span class="k">def</span> <span class="nf">outputs</span><span class="p">():</span>
            <span class="k">return</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;readMe!&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;In case of any errors, it will be shown here.&#39;</span><span class="p">},</span>

                    <span class="mi">1</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Weather&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;Livestock Weather Data Class&#39;</span><span class="p">}}</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">inputs</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">outputs</span> <span class="o">=</span> <span class="n">outputs</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">component_number</span> <span class="o">=</span> <span class="mi">12</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;Generates CMF weather&#39;</span> \
                           <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Icon art based created by Adrien Coquet from the Noun Project.&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">temp</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wind</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rel_hum</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cloud_cover</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">global_radiation</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rain</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ground_temp</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">location</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">face_count</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">checks</span> <span class="o">=</span> <span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">results</span> <span class="o">=</span> <span class="kc">None</span>

<div class="viewcode-block" id="CMFWeather.check_inputs"><a class="viewcode-back" href="../../../cmf.html#livestock.components.comp_cmf.CMFWeather.check_inputs">[docs]</a>    <span class="k">def</span> <span class="nf">check_inputs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Checks inputs and raises a warning if an input is not the correct type.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">checks</span> <span class="o">=</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="CMFWeather.config"><a class="viewcode-back" href="../../../cmf.html#livestock.components.comp_cmf.CMFWeather.config">[docs]</a>    <span class="k">def</span> <span class="nf">config</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generates the Grasshopper component.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Generate Component</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config_component</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">component_number</span><span class="p">)</span></div>

<div class="viewcode-block" id="CMFWeather.run_checks"><a class="viewcode-back" href="../../../cmf.html#livestock.components.comp_cmf.CMFWeather.run_checks">[docs]</a>    <span class="k">def</span> <span class="nf">run_checks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">temp</span><span class="p">,</span> <span class="n">wind</span><span class="p">,</span> <span class="n">rel_hum</span><span class="p">,</span> <span class="n">cloud_cover</span><span class="p">,</span> <span class="n">global_radiation</span><span class="p">,</span> <span class="n">rain</span><span class="p">,</span> <span class="n">ground_temp</span><span class="p">,</span> <span class="n">location</span><span class="p">,</span> <span class="n">face_count</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gathers the inputs and checks them.</span>
<span class="sd">        :param temp: Temperature</span>
<span class="sd">        :param wind: Wind speed</span>
<span class="sd">        :param rel_hum: Relative humidity</span>
<span class="sd">        :param cloud_cover: Cloud cover</span>
<span class="sd">        :param global_radiation: Global radiation</span>
<span class="sd">        :param rain: Rain</span>
<span class="sd">        :param ground_temp: Ground temperature.</span>
<span class="sd">        :param location: Ladybug Tool location</span>
<span class="sd">        :param face_count: Number of mesh faces in project</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Gather data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">face_count</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">face_count</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">temp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">match_cell_count</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wind</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">match_cell_count</span><span class="p">(</span><span class="n">wind</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rel_hum</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">match_cell_count</span><span class="p">(</span><span class="n">rel_hum</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cloud_cover</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">match_cell_count</span><span class="p">(</span><span class="n">cloud_cover</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">global_radiation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">match_cell_count</span><span class="p">(</span><span class="n">global_radiation</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rain</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">match_cell_count</span><span class="p">(</span><span class="n">rain</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ground_temp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">match_cell_count</span><span class="p">(</span><span class="n">ground_temp</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">location</span> <span class="o">=</span> <span class="n">location</span>

        <span class="c1"># Run checks</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">check_inputs</span><span class="p">()</span></div>

<div class="viewcode-block" id="CMFWeather.convert_cloud_cover"><a class="viewcode-back" href="../../../cmf.html#livestock.components.comp_cmf.CMFWeather.convert_cloud_cover">[docs]</a>    <span class="k">def</span> <span class="nf">convert_cloud_cover</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Converts cloud cover to sun shine fraction.</span>
<span class="sd">        sun shine = 1 - cloud cover</span>
<span class="sd">        :return: list with sun shine fractions.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">sun_shine</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">for</span> <span class="n">cloud_key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cloud_cover</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">sun_shine</span><span class="p">[</span><span class="n">cloud_key</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">cc</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cloud_cover</span><span class="p">[</span><span class="n">cloud_key</span><span class="p">]:</span>
                <span class="n">sun_shine</span><span class="p">[</span><span class="n">cloud_key</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="nb">float</span><span class="p">(</span><span class="n">cc</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">sun_shine</span></div>

<div class="viewcode-block" id="CMFWeather.convert_radiation_unit"><a class="viewcode-back" href="../../../cmf.html#livestock.components.comp_cmf.CMFWeather.convert_radiation_unit">[docs]</a>    <span class="k">def</span> <span class="nf">convert_radiation_unit</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Converts radiation from W/m2 to MJ/(m2*day)</span>
<span class="sd">        1 W/m2 =&gt; 60s*60min*24hours/10^6 =&gt; MJ/(m2*day)</span>
<span class="sd">        1 W/m2 = 0.0864 MJ/(m2*day)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">converted_radiation</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">for</span> <span class="n">radiation_key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">global_radiation</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">converted_radiation</span><span class="p">[</span><span class="n">radiation_key</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">rad</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">global_radiation</span><span class="p">[</span><span class="n">radiation_key</span><span class="p">]:</span>
                <span class="n">converted_radiation</span><span class="p">[</span><span class="n">radiation_key</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">rad</span><span class="p">)</span><span class="o">*</span><span class="mf">0.0864</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">global_radiation</span> <span class="o">=</span> <span class="n">converted_radiation</span></div>

<div class="viewcode-block" id="CMFWeather.convert_rain_unit"><a class="viewcode-back" href="../../../cmf.html#livestock.components.comp_cmf.CMFWeather.convert_rain_unit">[docs]</a>    <span class="k">def</span> <span class="nf">convert_rain_unit</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Converts rain from mm/h to mm/day</span>
<span class="sd">        1 mm/h = 24 mm/day</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">converted_rain</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">for</span> <span class="n">rain_key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rain</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">converted_rain</span><span class="p">[</span><span class="n">rain_key</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">rain</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rain</span><span class="p">[</span><span class="n">rain_key</span><span class="p">]:</span>
                <span class="n">converted_rain</span><span class="p">[</span><span class="n">rain_key</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">rain</span><span class="p">)</span> <span class="o">*</span> <span class="mi">24</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">rain</span> <span class="o">=</span> <span class="n">converted_rain</span></div>

<div class="viewcode-block" id="CMFWeather.convert_location"><a class="viewcode-back" href="../../../cmf.html#livestock.components.comp_cmf.CMFWeather.convert_location">[docs]</a>    <span class="k">def</span> <span class="nf">convert_location</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Extracts information from a Ladybug Tools location</span>
<span class="sd">        :return: Latitude, longitude and time zone</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">location_name</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">long_</span><span class="p">,</span> <span class="n">time_zone</span><span class="p">,</span> <span class="n">elevation</span> <span class="o">=</span> <span class="n">gh_misc</span><span class="o">.</span><span class="n">decompose_ladybug_location</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">location</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">lat</span><span class="p">,</span> <span class="n">long_</span><span class="p">,</span> <span class="n">time_zone</span></div>

<div class="viewcode-block" id="CMFWeather.match_cell_count"><a class="viewcode-back" href="../../../cmf.html#livestock.components.comp_cmf.CMFWeather.match_cell_count">[docs]</a>    <span class="k">def</span> <span class="nf">match_cell_count</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">weather_parameter</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Checks whether a whether a weather parameter has the correct number of sublists,</span>
<span class="sd">        so they matches the number of cells. Then converts it into a dict with a list for each cell.</span>
<span class="sd">        :param weather_parameter: Weather parameter to check.</span>
<span class="sd">        :return: Corrected weather parameter as dict.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="nf">find_list</span><span class="p">(</span><span class="n">weather_list_</span><span class="p">):</span>
            <span class="n">cleaned_list</span> <span class="o">=</span> <span class="p">[]</span>

            <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">weather_list_</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">element</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                    <span class="n">cleaned_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">element</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">pass</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">cleaned_list</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">cleaned_list</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">cleaned_list</span>

        <span class="n">weather_list</span> <span class="o">=</span> <span class="n">gh_misc</span><span class="o">.</span><span class="n">tree_to_list</span><span class="p">(</span><span class="n">weather_parameter</span><span class="p">)</span>
        <span class="n">clean_weather_list</span> <span class="o">=</span> <span class="n">find_list</span><span class="p">(</span><span class="n">weather_list</span><span class="p">)</span>
        <span class="n">weather_dict</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">clean_weather_list</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">weather_dict</span><span class="p">[</span><span class="s1">&#39;all&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">clean_weather_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">weather_list</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">face_count</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">weather_list</span><span class="p">)):</span>
                <span class="n">cell_number</span> <span class="o">=</span> <span class="s1">&#39;cell_&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
                <span class="n">weather_dict</span><span class="p">[</span><span class="n">cell_number</span><span class="p">]</span> <span class="o">=</span> <span class="n">weather_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">weather_dict</span></div>

<div class="viewcode-block" id="CMFWeather.print_weather_lengths"><a class="viewcode-back" href="../../../cmf.html#livestock.components.comp_cmf.CMFWeather.print_weather_lengths">[docs]</a>    <span class="k">def</span> <span class="nf">print_weather_lengths</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Prints the length of each weather parameter.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="nf">printer</span><span class="p">(</span><span class="n">parameter_name</span><span class="p">,</span> <span class="n">parameter</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">parameter_name</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; includes: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">parameter</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span> <span class="o">+</span> <span class="s1">&#39; lists&#39;</span><span class="p">)</span>

        <span class="n">printer</span><span class="p">(</span><span class="s1">&#39;Temperature&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">temp</span><span class="p">)</span>
        <span class="n">printer</span><span class="p">(</span><span class="s1">&#39;Wind Speed&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">wind</span><span class="p">)</span>
        <span class="n">printer</span><span class="p">(</span><span class="s1">&#39;Relative Humidity&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rel_hum</span><span class="p">)</span>
        <span class="n">printer</span><span class="p">(</span><span class="s1">&#39;Sun Shine&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">cloud_cover</span><span class="p">)</span>  <span class="c1"># are converted from cloud cover to sun later, but have same length.</span>
        <span class="n">printer</span><span class="p">(</span><span class="s1">&#39;Global Radiation&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">global_radiation</span><span class="p">)</span>
        <span class="n">printer</span><span class="p">(</span><span class="s1">&#39;Rain&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rain</span><span class="p">)</span>
        <span class="n">printer</span><span class="p">(</span><span class="s1">&#39;Ground Temperature&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ground_temp</span><span class="p">)</span></div>

<div class="viewcode-block" id="CMFWeather.run"><a class="viewcode-back" href="../../../cmf.html#livestock.components.comp_cmf.CMFWeather.run">[docs]</a>    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        In case all the checks have passed the component runs.</span>
<span class="sd">        The following functions are run:</span>
<span class="sd">        print_weather_lengths()</span>
<span class="sd">        convert_cloud_cover()</span>
<span class="sd">        convert_radiation_unit()</span>
<span class="sd">        convert_location()</span>
<span class="sd">        A weather dict is created an passes on with PassClass.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">checks</span><span class="p">:</span>
            <span class="c1"># Make print statement</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">print_weather_lengths</span><span class="p">()</span>

            <span class="c1"># Convertions</span>
            <span class="n">sun</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">convert_cloud_cover</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">convert_rain_unit</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">convert_radiation_unit</span><span class="p">()</span>
            <span class="n">latitude</span><span class="p">,</span> <span class="n">longitude</span><span class="p">,</span> <span class="n">time_zone</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">convert_location</span><span class="p">()</span>

            <span class="c1"># Construct dict</span>
            <span class="n">weather_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;temp&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">temp</span><span class="p">,</span>
                            <span class="s1">&#39;wind&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">wind</span><span class="p">,</span>
                            <span class="s1">&#39;rel_hum&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">rel_hum</span><span class="p">,</span>
                            <span class="s1">&#39;sun&#39;</span><span class="p">:</span> <span class="n">sun</span><span class="p">,</span>
                            <span class="s1">&#39;rad&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">global_radiation</span><span class="p">,</span>
                            <span class="s1">&#39;rain&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">rain</span><span class="p">,</span>
                            <span class="s1">&#39;ground_temp&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">ground_temp</span><span class="p">,</span>
                            <span class="s1">&#39;latitude&#39;</span><span class="p">:</span> <span class="n">latitude</span><span class="p">,</span>
                            <span class="s1">&#39;longitude&#39;</span><span class="p">:</span> <span class="n">longitude</span><span class="p">,</span>
                            <span class="s1">&#39;time_zone&#39;</span><span class="p">:</span> <span class="n">time_zone</span><span class="p">}</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">results</span> <span class="o">=</span> <span class="n">gh_misc</span><span class="o">.</span><span class="n">PassClass</span><span class="p">(</span><span class="n">weather_dict</span><span class="p">,</span> <span class="s1">&#39;Weather&#39;</span><span class="p">)</span></div></div>


<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">class CMFStream(GHComponent):</span>

<span class="sd">    def __init__(self):</span>
<span class="sd">        GHComponent.__init__(self)</span>

<span class="sd">        def inputs(x):</span>
<span class="sd">            if x == 0:</span>
<span class="sd">                return {0: [&#39;MidStreamCurve&#39;, &#39;Curve following the middle of the stream&#39;],</span>
<span class="sd">                        1: [&#39;CrossSections&#39;,&#39;Cross section curves along the stream&#39;]}</span>

<span class="sd">        def outputs():</span>
<span class="sd">            return {0: [&#39;readMe!&#39;, &#39;In case of any errors, it will be shown here.&#39;],</span>
<span class="sd">                    1: [&#39;Stream&#39;, &#39;Livestock Stream Data Class&#39;],</span>
<span class="sd">                    2: [&#39;ReconstructedStream&#39;, &#39;The reconstructed stream as represented in CMF&#39;]}</span>

<span class="sd">        self.inputs = inputs(0)</span>
<span class="sd">        self.outputs = outputs()</span>
<span class="sd">        self.component_number = 13</span>
<span class="sd">        self.mid_curve = None</span>
<span class="sd">        self.cross_sections = None</span>
<span class="sd">        self.shape = []</span>
<span class="sd">        self.x = None</span>
<span class="sd">        self.y = None</span>
<span class="sd">        self.z = None</span>
<span class="sd">        self.lengths = None</span>
<span class="sd">        self.width = None</span>
<span class="sd">        self.slope_bank = None</span>
<span class="sd">        self.water_depth = None</span>
<span class="sd">        self.checks = [False, False]</span>
<span class="sd">        self.results = None</span>

<span class="sd">    def check_inputs(self, ghenv):</span>
<span class="sd">        warning = []</span>

<span class="sd">        if self.mid_curve:</span>
<span class="sd">            self.checks = True</span>

<span class="sd">    def config(self, ghenv):</span>

<span class="sd">        # Generate Component</span>
<span class="sd">        self.config_component(ghenv, self.component_number)</span>

<span class="sd">    def run_checks(self, ghenv, mid_curve, cross_sections):</span>
<span class="sd">        # Gather data</span>
<span class="sd">        self.mid_curve = mid_curve</span>
<span class="sd">        self.cross_sections = cross_sections</span>

<span class="sd">        # Run checks</span>
<span class="sd">        self.check_inputs(ghenv)</span>

<span class="sd">    def process_curves(self):</span>

<span class="sd">        def intersection_mid_cross_section_curves(cross_sections, mid_curve):</span>

<span class="sd">            # get cross section vertices and mid point and cross section intersections</span>
<span class="sd">            intersection_points = []</span>
<span class="sd">            cross_section_verts = []</span>

<span class="sd">            for crv in cross_sections:</span>
<span class="sd">                intersection_points.append(rs.CurveCurveIntersection(mid_curve, crv)[0][1])</span>
<span class="sd">                cross_section_verts.append(rs.PolylineVertices(crv))</span>

<span class="sd">            if len(cross_section_verts[0]) == 3:</span>
<span class="sd">                shape = 0 # triangular reach</span>
<span class="sd">                return intersection_points, cross_section_verts, shape</span>
<span class="sd">            elif len(cross_section_verts[0]) == 4:</span>
<span class="sd">                shape = 1 # rectangular reach</span>
<span class="sd">                return intersection_points, cross_section_verts, shape</span>
<span class="sd">            else:</span>
<span class="sd">                print(&#39;Error in shape&#39;)</span>
<span class="sd">                return None, None, None</span>

<span class="sd">        def get_mid_points(intersection_points):</span>
<span class="sd">            mid_points = []</span>
<span class="sd">            x = []</span>
<span class="sd">            y = []</span>
<span class="sd">            z = []</span>

<span class="sd">            for i in range(len(intersection_points)):</span>
<span class="sd">                pt = intersection_points[i] - intersection_points[i + 1]</span>
<span class="sd">                mid_points.append(pt)</span>
<span class="sd">                x.append(pt.X)</span>
<span class="sd">                y.append(pt.Y)</span>
<span class="sd">                z.append(pt.Z)</span>

<span class="sd">            return mid_points, x, y, z</span>

<span class="sd">        def sort_cross_section_verts(cross_section_verts, shape):</span>
<span class="sd">            if shape == 0:</span>
<span class="sd">                left = []</span>
<span class="sd">                right = []</span>
<span class="sd">                bottom = []</span>
<span class="sd">                for i in range(len(cross_section_verts)):</span>
<span class="sd">                    pass</span>
<span class="sd">            elif shape == 1:</span>
<span class="sd">                return</span>
<span class="sd">            else:</span>
<span class="sd">                print(&#39;Shape with value:&#39;, str(shape), &#39;not defined!&#39;)</span>
<span class="sd">                return None</span>

<span class="sd">        intersection_points, cross_section_verts, self.shape = intersection_mid_cross_section_curves(self.cross_sections, self.mid_curve)</span>

<span class="sd">        return None</span>

<span class="sd">    def run(self):</span>
<span class="sd">        if self.checks:</span>
<span class="sd">            ground_dict = {&#39;mesh&#39;: self.mesh,</span>
<span class="sd">                           &#39;layers&#39;: self.layers,</span>
<span class="sd">                           &#39;retention_curve&#39;: self.retention_curve,</span>
<span class="sd">                           &#39;grass&#39;: self.grass,</span>
<span class="sd">                           &#39;initial_saturation&#39;: self.initial_saturation}</span>

<span class="sd">            self.results = gh_misc.PassClass(ground_dict, &#39;CMF_Ground&#39;)</span>
<span class="sd">&quot;&quot;&quot;</span>


<div class="viewcode-block" id="CMFVegetationProperties"><a class="viewcode-back" href="../../../cmf.html#livestock.components.comp_cmf.CMFVegetationProperties">[docs]</a><span class="k">class</span> <span class="nc">CMFVegetationProperties</span><span class="p">(</span><span class="n">GHComponent</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ghenv</span><span class="p">):</span>
        <span class="n">GHComponent</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ghenv</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">inputs</span><span class="p">():</span>
            <span class="k">return</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Property&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;0-1 grasses. 2-6 soils&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;access&#39;</span><span class="p">:</span> <span class="s1">&#39;item&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;default_value&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">}</span>
                    <span class="p">}</span>

        <span class="k">def</span> <span class="nf">outputs</span><span class="p">():</span>
            <span class="k">return</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;readMe!&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;In case of any errors, it will be shown here.&#39;</span><span class="p">},</span>

                    <span class="mi">1</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Units&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;Shows the units of the surface values&#39;</span><span class="p">},</span>

                    <span class="mi">2</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;VegetationValues&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;Chosen surface properties values&#39;</span><span class="p">},</span>

                    <span class="mi">3</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;VegetationProperties&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;Livestock surface properties data&#39;</span><span class="p">}}</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">inputs</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">outputs</span> <span class="o">=</span> <span class="n">outputs</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">component_number</span> <span class="o">=</span> <span class="mi">13</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;Generates CMF Vegetation Properties&#39;</span> \
                           <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Icon art based created by Ben Davis from the Noun Project.&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s1">&#39;APPDATA&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39;\McNeel\Rhinoceros\5.0\scripts\livestock\data\vegetation_data.csv&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">property_index</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">property</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">checks</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">results</span> <span class="o">=</span> <span class="kc">None</span>

<div class="viewcode-block" id="CMFVegetationProperties.check_inputs"><a class="viewcode-back" href="../../../cmf.html#livestock.components.comp_cmf.CMFVegetationProperties.check_inputs">[docs]</a>    <span class="k">def</span> <span class="nf">check_inputs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Checks inputs and raises a warning if an input is not the correct type.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">checks</span> <span class="o">=</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="CMFVegetationProperties.config"><a class="viewcode-back" href="../../../cmf.html#livestock.components.comp_cmf.CMFVegetationProperties.config">[docs]</a>    <span class="k">def</span> <span class="nf">config</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generates the Grasshopper component.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Generate Component</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config_component</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">component_number</span><span class="p">)</span></div>

<div class="viewcode-block" id="CMFVegetationProperties.run_checks"><a class="viewcode-back" href="../../../cmf.html#livestock.components.comp_cmf.CMFVegetationProperties.run_checks">[docs]</a>    <span class="k">def</span> <span class="nf">run_checks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">property_</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gathers the inputs and checks them.</span>
<span class="sd">        :param property_: Property index.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Gather data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">property_index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_default_value</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">property_</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>

        <span class="c1"># Run checks</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">check_inputs</span><span class="p">()</span></div>

<div class="viewcode-block" id="CMFVegetationProperties.load_csv"><a class="viewcode-back" href="../../../cmf.html#livestock.components.comp_cmf.CMFVegetationProperties.load_csv">[docs]</a>    <span class="k">def</span> <span class="nf">load_csv</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Loads a csv file with the vegetation properties.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">load</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_path</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="n">load</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">load</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span></div>

<div class="viewcode-block" id="CMFVegetationProperties.pick_property"><a class="viewcode-back" href="../../../cmf.html#livestock.components.comp_cmf.CMFVegetationProperties.pick_property">[docs]</a>    <span class="k">def</span> <span class="nf">pick_property</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Selects the correct vegetation property. And stores it as a ordered dict.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">load_csv</span><span class="p">()</span>
        <span class="n">data_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">property_index</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">property</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">OrderedDict</span><span class="p">([(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                                                 <span class="p">(</span><span class="s1">&#39;height&#39;</span><span class="p">,</span> <span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
                                                 <span class="p">(</span><span class="s1">&#39;lai&#39;</span><span class="p">,</span> <span class="n">data_list</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span>
                                                 <span class="p">(</span><span class="s1">&#39;albedo&#39;</span><span class="p">,</span> <span class="n">data_list</span><span class="p">[</span><span class="mi">3</span><span class="p">]),</span>
                                                 <span class="p">(</span><span class="s1">&#39;canopy_closure&#39;</span><span class="p">,</span> <span class="n">data_list</span><span class="p">[</span><span class="mi">4</span><span class="p">]),</span>
                                                 <span class="p">(</span><span class="s1">&#39;canopy_par&#39;</span><span class="p">,</span> <span class="n">data_list</span><span class="p">[</span><span class="mi">5</span><span class="p">]),</span>
                                                 <span class="p">(</span><span class="s1">&#39;canopy_capacity&#39;</span><span class="p">,</span> <span class="n">data_list</span><span class="p">[</span><span class="mi">6</span><span class="p">]),</span>
                                                 <span class="p">(</span><span class="s1">&#39;stomatal_res&#39;</span><span class="p">,</span> <span class="n">data_list</span><span class="p">[</span><span class="mi">7</span><span class="p">]),</span>
                                                 <span class="p">(</span><span class="s1">&#39;root_depth&#39;</span><span class="p">,</span> <span class="n">data_list</span><span class="p">[</span><span class="mi">8</span><span class="p">]),</span>
                                                 <span class="p">(</span><span class="s1">&#39;root_fraction&#39;</span><span class="p">,</span> <span class="n">data_list</span><span class="p">[</span><span class="mi">9</span><span class="p">]),</span>
                                                 <span class="p">(</span><span class="s1">&#39;leaf_width&#39;</span><span class="p">,</span> <span class="mf">0.005</span><span class="p">)</span>
                                                 <span class="p">])</span></div>

<div class="viewcode-block" id="CMFVegetationProperties.run"><a class="viewcode-back" href="../../../cmf.html#livestock.components.comp_cmf.CMFVegetationProperties.run">[docs]</a>    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        In case all the checks have passed the component runs.</span>
<span class="sd">        It run pick_properties()</span>
<span class="sd">        And passes on the property dict with PassClass.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">checks</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pick_property</span><span class="p">()</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">results</span> <span class="o">=</span> <span class="n">gh_misc</span><span class="o">.</span><span class="n">PassClass</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">property</span><span class="p">,</span> <span class="s1">&#39;VegetationProperty&#39;</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="CMFSyntheticTree"><a class="viewcode-back" href="../../../cmf.html#livestock.components.comp_cmf.CMFSyntheticTree">[docs]</a><span class="k">class</span> <span class="nc">CMFSyntheticTree</span><span class="p">(</span><span class="n">GHComponent</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ghenv</span><span class="p">):</span>
        <span class="n">GHComponent</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ghenv</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">inputs</span><span class="p">():</span>
            <span class="k">return</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;FaceIndex&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;Mesh face index where tree is placed&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;access&#39;</span><span class="p">:</span> <span class="s1">&#39;item&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;default_value&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">},</span>
                    <span class="mi">1</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;TreeType&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;Tree types: 0 - Deciduous, 1 - Coniferous, 2 - Shrubs. Default is deciduous&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;access&#39;</span><span class="p">:</span> <span class="s1">&#39;item&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;default_value&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">},</span>
                    <span class="mi">2</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Height&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;Height of tree in meters. Default is set to 10m&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;access&#39;</span><span class="p">:</span> <span class="s1">&#39;item&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;default_value&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">}}</span>

        <span class="k">def</span> <span class="nf">outputs</span><span class="p">():</span>
            <span class="k">return</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;readMe!&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;In case of any errors, it will be shown here.&#39;</span><span class="p">},</span>
                    <span class="mi">1</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Units&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;Shows the units of the tree values&#39;</span><span class="p">},</span>
                    <span class="mi">2</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;TreeValues&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;Chosen tree properties values&#39;</span><span class="p">},</span>
                    <span class="mi">3</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;TreeProperties&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;Livestock tree properties data&#39;</span><span class="p">}}</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">inputs</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">outputs</span> <span class="o">=</span> <span class="n">outputs</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">component_number</span> <span class="o">=</span> <span class="mi">18</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;Generates a synthetic tree&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data_path</span> <span class="o">=</span> <span class="p">[</span><span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s1">&#39;APPDATA&#39;</span><span class="p">)</span> <span class="o">+</span>
                          <span class="sa">r</span><span class="s1">&#39;\McNeel\Rhinoceros\5.0\scripts\livestock\data\syntheticDeciduous.csv&#39;</span><span class="p">,</span>
                          <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s1">&#39;APPDATA&#39;</span><span class="p">)</span> <span class="o">+</span>
                          <span class="sa">r</span><span class="s1">&#39;\McNeel\Rhinoceros\5.0\scripts\livestock\data\syntheticConiferous.csv&#39;</span><span class="p">,</span>
                          <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s1">&#39;APPDATA&#39;</span><span class="p">)</span> <span class="o">+</span>
                          <span class="sa">r</span><span class="s1">&#39;\McNeel\Rhinoceros\5.0\scripts\livestock\data\syntheticShrubs.csv&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tree_type</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">height</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">property</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">face_index</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">checks</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">results</span> <span class="o">=</span> <span class="kc">None</span>

<div class="viewcode-block" id="CMFSyntheticTree.check_inputs"><a class="viewcode-back" href="../../../cmf.html#livestock.components.comp_cmf.CMFSyntheticTree.check_inputs">[docs]</a>    <span class="k">def</span> <span class="nf">check_inputs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Checks inputs and raises a warning if an input is not the correct type.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">height</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">checks</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">warning</span> <span class="o">=</span> <span class="s1">&#39;Temperature should be a float&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_warning</span><span class="p">(</span><span class="n">warning</span><span class="p">)</span></div>

<div class="viewcode-block" id="CMFSyntheticTree.config"><a class="viewcode-back" href="../../../cmf.html#livestock.components.comp_cmf.CMFSyntheticTree.config">[docs]</a>    <span class="k">def</span> <span class="nf">config</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generates the Grasshopper component.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Generate Component</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config_component</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">component_number</span><span class="p">)</span></div>

<div class="viewcode-block" id="CMFSyntheticTree.run_checks"><a class="viewcode-back" href="../../../cmf.html#livestock.components.comp_cmf.CMFSyntheticTree.run_checks">[docs]</a>    <span class="k">def</span> <span class="nf">run_checks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">face_index</span><span class="p">,</span> <span class="n">tree_type</span><span class="p">,</span> <span class="n">height</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gathers the inputs and checks them.</span>
<span class="sd">        :param face_index: Mesh face index.</span>
<span class="sd">        :param tree_type: Tree type.</span>
<span class="sd">        :param height: Tree height.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Gather data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">face_index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_default_value</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">face_index</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tree_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_default_value</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">tree_type</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">height</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_default_value</span><span class="p">(</span><span class="n">height</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

        <span class="c1"># Run checks</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">check_inputs</span><span class="p">()</span></div>

<div class="viewcode-block" id="CMFSyntheticTree.load_csv"><a class="viewcode-back" href="../../../cmf.html#livestock.components.comp_cmf.CMFSyntheticTree.load_csv">[docs]</a>    <span class="k">def</span> <span class="nf">load_csv</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Loads a csv file with the tree properties.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">load</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_path</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">tree_type</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="n">load</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">load</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span></div>

<div class="viewcode-block" id="CMFSyntheticTree.compute_tree"><a class="viewcode-back" href="../../../cmf.html#livestock.components.comp_cmf.CMFSyntheticTree.compute_tree">[docs]</a>    <span class="k">def</span> <span class="nf">compute_tree</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Selects the correct tree property. It computes the property information and stores it as a ordered dict.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">load_csv</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">property</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">OrderedDict</span><span class="p">([(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;Synthetic Deciduous&#39;</span><span class="p">),</span>
                                                 <span class="p">(</span><span class="s1">&#39;height&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">height</span><span class="p">),</span>
                                                 <span class="p">(</span><span class="s1">&#39;lai&#39;</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">height</span> <span class="o">+</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">])),</span>
                                                 <span class="p">(</span><span class="s1">&#39;albedo&#39;</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">])</span> <span class="o">*</span>
                                                  <span class="bp">self</span><span class="o">.</span><span class="n">height</span> <span class="o">+</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">3</span><span class="p">])),</span>
                                                 <span class="p">(</span><span class="s1">&#39;canopy_closure&#39;</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">4</span><span class="p">])),</span>
                                                 <span class="p">(</span><span class="s1">&#39;canopy_par&#39;</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">5</span><span class="p">])),</span>
                                                 <span class="p">(</span><span class="s1">&#39;canopy_capacity&#39;</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">6</span><span class="p">])</span> <span class="o">*</span>
                                                  <span class="bp">self</span><span class="o">.</span><span class="n">height</span> <span class="o">+</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">6</span><span class="p">])),</span>
                                                 <span class="p">(</span><span class="s1">&#39;stomatal_res&#39;</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">7</span><span class="p">])</span> <span class="o">*</span>
                                                  <span class="bp">self</span><span class="o">.</span><span class="n">height</span> <span class="o">+</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">7</span><span class="p">])),</span>
                                                 <span class="p">(</span><span class="s1">&#39;root_depth&#39;</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">8</span><span class="p">])),</span>
                                                 <span class="p">(</span><span class="s1">&#39;root_fraction&#39;</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">9</span><span class="p">])),</span>
                                                 <span class="p">(</span><span class="s1">&#39;leaf_width&#39;</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">)</span>
                                                 <span class="p">])</span></div>

<div class="viewcode-block" id="CMFSyntheticTree.run"><a class="viewcode-back" href="../../../cmf.html#livestock.components.comp_cmf.CMFSyntheticTree.run">[docs]</a>    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        In case all the checks have passed the component runs.</span>
<span class="sd">        It runs the function compute_tree. Creates a dict and passes it on with PassClass.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">checks</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">compute_tree</span><span class="p">()</span>
            <span class="n">dic</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;face_index&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">face_index</span><span class="p">,</span>
                   <span class="s1">&#39;property&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">property</span><span class="p">}</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">results</span> <span class="o">=</span> <span class="n">gh_misc</span><span class="o">.</span><span class="n">PassClass</span><span class="p">(</span><span class="n">dic</span><span class="p">,</span> <span class="s1">&#39;SyntheticTreeProperty&#39;</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="CMFRetentionCurve"><a class="viewcode-back" href="../../../cmf.html#livestock.components.comp_cmf.CMFRetentionCurve">[docs]</a><span class="k">class</span> <span class="nc">CMFRetentionCurve</span><span class="p">(</span><span class="n">GHComponent</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ghenv</span><span class="p">):</span>
        <span class="n">GHComponent</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ghenv</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">inputs</span><span class="p">():</span>
            <span class="k">return</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;SoilIndex&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;Index for choosing soil type. Index from 0-5.</span><span class="se">\n</span><span class="s1">&#39;</span>
                                       <span class="s1">&#39;Default is set to 0, which is the default CMF retention curve.&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;access&#39;</span><span class="p">:</span> <span class="s1">&#39;item&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;default_value&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">},</span>

                    <span class="mi">1</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;K_sat&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;Saturated conductivity in m/day&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;access&#39;</span><span class="p">:</span> <span class="s1">&#39;item&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;default_value&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">},</span>

                    <span class="mi">2</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Phi&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;Porosity in m3/m3&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;access&#39;</span><span class="p">:</span> <span class="s1">&#39;item&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;default_value&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">},</span>

                    <span class="mi">3</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Alpha&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;Inverse of water entry potential in 1/cm&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;access&#39;</span><span class="p">:</span> <span class="s1">&#39;item&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;default_value&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">},</span>

                    <span class="mi">4</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;N&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;Pore size distribution parameter is unitless&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;access&#39;</span><span class="p">:</span> <span class="s1">&#39;item&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;default_value&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">},</span>

                    <span class="mi">5</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;M&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;VanGenuchten m (if negative, 1-1/n is used) is unitless&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;access&#39;</span><span class="p">:</span> <span class="s1">&#39;item&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;default_value&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">},</span>

                    <span class="mi">6</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;L&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;Mualem tortoisivity is unitless&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;access&#39;</span><span class="p">:</span> <span class="s1">&#39;item&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;default_value&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">}</span>
                    <span class="p">}</span>

        <span class="k">def</span> <span class="nf">outputs</span><span class="p">():</span>
            <span class="k">return</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;readMe!&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;In case of any errors, it will be shown here.&#39;</span><span class="p">},</span>
                    <span class="mi">1</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Units&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;Shows the units of the curve values&#39;</span><span class="p">},</span>
                    <span class="mi">2</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;CurveValues&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;Chosen curve properties values&#39;</span><span class="p">},</span>
                    <span class="mi">3</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;RetentionCurve&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;Livestock Retention Curve&#39;</span><span class="p">}}</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">inputs</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">outputs</span> <span class="o">=</span> <span class="n">outputs</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">component_number</span> <span class="o">=</span> <span class="mi">15</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;Generates retention curve&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s1">&#39;APPDATA&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39;\McNeel\Rhinoceros\5.0\scripts\livestock\data\retention_curves.csv&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">property</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">soil_index</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">k_sat</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">phi</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">l</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">checks</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">results</span> <span class="o">=</span> <span class="kc">None</span>

<div class="viewcode-block" id="CMFRetentionCurve.check_inputs"><a class="viewcode-back" href="../../../cmf.html#livestock.components.comp_cmf.CMFRetentionCurve.check_inputs">[docs]</a>    <span class="k">def</span> <span class="nf">check_inputs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Checks inputs and raises a warning if an input is not the correct type.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">checks</span> <span class="o">=</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="CMFRetentionCurve.config"><a class="viewcode-back" href="../../../cmf.html#livestock.components.comp_cmf.CMFRetentionCurve.config">[docs]</a>    <span class="k">def</span> <span class="nf">config</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generates the Grasshopper component.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Generate Component</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config_component</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">component_number</span><span class="p">)</span></div>

<div class="viewcode-block" id="CMFRetentionCurve.run_checks"><a class="viewcode-back" href="../../../cmf.html#livestock.components.comp_cmf.CMFRetentionCurve.run_checks">[docs]</a>    <span class="k">def</span> <span class="nf">run_checks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">soil_index</span><span class="p">,</span> <span class="n">k_sat</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">l</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gathers the inputs and checks them.</span>
<span class="sd">        :param soil_index: Soil index.</span>
<span class="sd">        :param k_sat: Ksat</span>
<span class="sd">        :param phi: Phi</span>
<span class="sd">        :param alpha: Alpha</span>
<span class="sd">        :param n: N</span>
<span class="sd">        :param m: M</span>
<span class="sd">        :param l: L</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Gather data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">soil_index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_default_value</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">soil_index</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">k_sat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_default_value</span><span class="p">(</span><span class="n">k_sat</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">phi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_default_value</span><span class="p">(</span><span class="n">phi</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_default_value</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_default_value</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_default_value</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">l</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_default_value</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>

        <span class="c1"># Run checks</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">check_inputs</span><span class="p">()</span></div>

<div class="viewcode-block" id="CMFRetentionCurve.load_csv"><a class="viewcode-back" href="../../../cmf.html#livestock.components.comp_cmf.CMFRetentionCurve.load_csv">[docs]</a>    <span class="k">def</span> <span class="nf">load_csv</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Loads a csv file with the retention curve data.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">load</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_path</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="n">load</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">load</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span></div>

<div class="viewcode-block" id="CMFRetentionCurve.load_retention_curve"><a class="viewcode-back" href="../../../cmf.html#livestock.components.comp_cmf.CMFRetentionCurve.load_retention_curve">[docs]</a>    <span class="k">def</span> <span class="nf">load_retention_curve</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Loads the retention curve data and converts it into a order dict.</span>
<span class="sd">        If any property is to be overwritten it is also done in this function.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">load_csv</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">property</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">OrderedDict</span><span class="p">([(</span><span class="s1">&#39;type&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">soil_index</span><span class="p">][</span><span class="mi">0</span><span class="p">])),</span>
                                                 <span class="p">(</span><span class="s1">&#39;K_sat&#39;</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">soil_index</span><span class="p">][</span><span class="mi">1</span><span class="p">])),</span>
                                                 <span class="p">(</span><span class="s1">&#39;phi&#39;</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">soil_index</span><span class="p">][</span><span class="mi">2</span><span class="p">])),</span>
                                                 <span class="p">(</span><span class="s1">&#39;alpha&#39;</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">soil_index</span><span class="p">][</span><span class="mi">3</span><span class="p">])),</span>
                                                 <span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">soil_index</span><span class="p">][</span><span class="mi">4</span><span class="p">])),</span>
                                                 <span class="p">(</span><span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">soil_index</span><span class="p">][</span><span class="mi">5</span><span class="p">])),</span>
                                                 <span class="p">(</span><span class="s1">&#39;l&#39;</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">soil_index</span><span class="p">][</span><span class="mi">6</span><span class="p">]))</span>
                                                 <span class="p">])</span>

        <span class="c1"># Set modified properties</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">k_sat</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">property</span><span class="p">[</span><span class="s1">&#39;K_sat&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">k_sat</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">property</span><span class="p">[</span><span class="s1">&#39;phi&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">phi</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">property</span><span class="p">[</span><span class="s1">&#39;alpha&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">property</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">property</span><span class="p">[</span><span class="s1">&#39;m&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">m</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">l</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">property</span><span class="p">[</span><span class="s1">&#39;l&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">l</span>

        <span class="k">return</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="CMFRetentionCurve.run"><a class="viewcode-back" href="../../../cmf.html#livestock.components.comp_cmf.CMFRetentionCurve.run">[docs]</a>    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        In case all the checks have passed the component runs.</span>
<span class="sd">        Loads the retention curve data and passes it on with PassClass.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">checks</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">load_retention_curve</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">results</span> <span class="o">=</span> <span class="n">gh_misc</span><span class="o">.</span><span class="n">PassClass</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">property</span><span class="p">,</span> <span class="s1">&#39;RetentionCurve&#39;</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="CMFSolve"><a class="viewcode-back" href="../../../cmf.html#livestock.components.comp_cmf.CMFSolve">[docs]</a><span class="k">class</span> <span class="nc">CMFSolve</span><span class="p">(</span><span class="n">GHComponent</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ghenv</span><span class="p">):</span>
        <span class="n">GHComponent</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ghenv</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">inputs</span><span class="p">():</span>
            <span class="k">return</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Mesh&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;Topography as a mesh&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;access&#39;</span><span class="p">:</span> <span class="s1">&#39;item&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;default_value&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">},</span>

                    <span class="mi">1</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Ground&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;Input from Livestock CMF Ground&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;access&#39;</span><span class="p">:</span> <span class="s1">&#39;list&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;default_value&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">},</span>

                    <span class="mi">2</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Weather&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;Input from Livestock CMF Weather&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;access&#39;</span><span class="p">:</span> <span class="s1">&#39;item&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;default_value&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">},</span>

                    <span class="mi">3</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Trees&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;Input from Livestock CMF Tree&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;access&#39;</span><span class="p">:</span> <span class="s1">&#39;list&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;default_value&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">},</span>

                    <span class="mi">4</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Stream&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;Input from Livestock CMF Stream&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;access&#39;</span><span class="p">:</span> <span class="s1">&#39;item&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;default_value&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">},</span>

                    <span class="mi">5</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;BoundaryConditions&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;Input from Livestock CMF Boundary Condition&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;access&#39;</span><span class="p">:</span> <span class="s1">&#39;list&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;default_value&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">},</span>

                    <span class="mi">6</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;SolverSettings&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;Input from Livestock CMF Solver Settings&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;access&#39;</span><span class="p">:</span> <span class="s1">&#39;item&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;default_value&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">},</span>

                    <span class="mi">7</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Folder&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;Path to folder. Default is Desktop&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;access&#39;</span><span class="p">:</span> <span class="s1">&#39;item&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;default_value&#39;</span><span class="p">:</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;HOMEPATH&quot;</span><span class="p">],</span> <span class="s2">&quot;Desktop&quot;</span><span class="p">)},</span>

                    <span class="mi">8</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;CaseName&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;Case name as string. Default is CMF&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;access&#39;</span><span class="p">:</span> <span class="s1">&#39;item&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;default_value&#39;</span><span class="p">:</span> <span class="s1">&#39;CMF&#39;</span><span class="p">},</span>

                    <span class="mi">9</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Outputs&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;Connect Livestock Outputs&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;access&#39;</span><span class="p">:</span> <span class="s1">&#39;item&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;default_value&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">},</span>

                    <span class="mi">10</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Write&#39;</span><span class="p">,</span>
                         <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;Boolean to write files&#39;</span><span class="p">,</span>
                         <span class="s1">&#39;access&#39;</span><span class="p">:</span> <span class="s1">&#39;item&#39;</span><span class="p">,</span>
                         <span class="s1">&#39;default_value&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">},</span>

                    <span class="mi">11</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Overwrite&#39;</span><span class="p">,</span>
                         <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;If True excising case will be overwritten. Default is set to True&#39;</span><span class="p">,</span>
                         <span class="s1">&#39;access&#39;</span><span class="p">:</span> <span class="s1">&#39;item&#39;</span><span class="p">,</span>
                         <span class="s1">&#39;default_value&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">},</span>

                    <span class="mi">12</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Run&#39;</span><span class="p">,</span>
                         <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;Boolean to run analysis&#39;</span>
                         <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Analysis will be ran through SSH. Configure the connection with Livestock SSH&#39;</span><span class="p">,</span>
                         <span class="s1">&#39;access&#39;</span><span class="p">:</span> <span class="s1">&#39;item&#39;</span><span class="p">,</span>
                         <span class="s1">&#39;default_value&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">}}</span>

        <span class="k">def</span> <span class="nf">outputs</span><span class="p">():</span>
            <span class="k">return</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;readMe!&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;In case of any errors, it will be shown here.&#39;</span><span class="p">},</span>

                    <span class="mi">1</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;ResultPath&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;Path to result files&#39;</span><span class="p">}}</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">inputs</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">outputs</span> <span class="o">=</span> <span class="n">outputs</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">component_number</span> <span class="o">=</span> <span class="mi">14</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;Solves CMF Case.</span><span class="se">\n</span><span class="s1">&#39;</span> \
                           <span class="s1">&#39;Icon art based on Vectors Market from the Noun Project.&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mesh</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ground</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">weather</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">trees</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stream</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">boundary_conditions</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">solver_settings</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">folder</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">case_name</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">case_path</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write_case</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">overwrite</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">output_config</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">run_case</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">py_exe</span> <span class="o">=</span> <span class="n">gh_misc</span><span class="o">.</span><span class="n">get_python_exe</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">written</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">checks</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">results</span> <span class="o">=</span> <span class="kc">None</span>

<div class="viewcode-block" id="CMFSolve.check_inputs"><a class="viewcode-back" href="../../../cmf.html#livestock.components.comp_cmf.CMFSolve.check_inputs">[docs]</a>    <span class="k">def</span> <span class="nf">check_inputs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Checks inputs and raises a warning if an input is not the correct type.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ground</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">checks</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">warning</span> <span class="o">=</span> <span class="s1">&#39;Temperature should be a float&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_warning</span><span class="p">(</span><span class="n">warning</span><span class="p">)</span></div>

<div class="viewcode-block" id="CMFSolve.config"><a class="viewcode-back" href="../../../cmf.html#livestock.components.comp_cmf.CMFSolve.config">[docs]</a>    <span class="k">def</span> <span class="nf">config</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generates the Grasshopper component.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Generate Component</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config_component</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">component_number</span><span class="p">)</span></div>

<div class="viewcode-block" id="CMFSolve.run_checks"><a class="viewcode-back" href="../../../cmf.html#livestock.components.comp_cmf.CMFSolve.run_checks">[docs]</a>    <span class="k">def</span> <span class="nf">run_checks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mesh</span><span class="p">,</span> <span class="n">ground</span><span class="p">,</span> <span class="n">weather</span><span class="p">,</span> <span class="n">trees</span><span class="p">,</span> <span class="n">stream</span><span class="p">,</span> <span class="n">boundary_conditions</span><span class="p">,</span> <span class="n">solver_settings</span><span class="p">,</span> <span class="n">folder</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span>
                   <span class="n">outputs</span><span class="p">,</span> <span class="n">write</span><span class="p">,</span> <span class="n">overwrite</span><span class="p">,</span> <span class="n">run</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gathers the inputs and checks them.</span>
<span class="sd">        :param mesh: Project Mesh</span>
<span class="sd">        :param ground: Livestock Ground dict</span>
<span class="sd">        :param weather: Livestock Weather dict</span>
<span class="sd">        :param trees: Livestock Tree dict</span>
<span class="sd">        :param stream: Livestock Stream dict</span>
<span class="sd">        :param boundary_conditions: Livestock Boundary Condition dict</span>
<span class="sd">        :param solver_settings: Livestock Solver settings dict</span>
<span class="sd">        :param folder: Case folder</span>
<span class="sd">        :param name: Case name</span>
<span class="sd">        :param outputs: Livestock Outputs dict</span>
<span class="sd">        :param write: Whether to write or not</span>
<span class="sd">        :param overwrite: Overwrite exsiting files</span>
<span class="sd">        :param run: Whether to run or not.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Gather data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mesh</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_default_value</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ground</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_default_value</span><span class="p">(</span><span class="n">ground</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">weather</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_default_value</span><span class="p">(</span><span class="n">weather</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">trees</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_default_value</span><span class="p">(</span><span class="n">trees</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stream</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_default_value</span><span class="p">(</span><span class="n">stream</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">boundary_conditions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_default_value</span><span class="p">(</span><span class="n">boundary_conditions</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">solver_settings</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_default_value</span><span class="p">(</span><span class="n">solver_settings</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">folder</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_default_value</span><span class="p">(</span><span class="n">folder</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">case_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_default_value</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">output_config</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_default_value</span><span class="p">(</span><span class="n">outputs</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write_case</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_default_value</span><span class="p">(</span><span class="n">write</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">overwrite</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_default_value</span><span class="p">(</span><span class="n">overwrite</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">run_case</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_default_value</span><span class="p">(</span><span class="n">run</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_case_path</span><span class="p">()</span>

        <span class="c1"># Run checks</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">check_inputs</span><span class="p">()</span></div>

<div class="viewcode-block" id="CMFSolve.update_case_path"><a class="viewcode-back" href="../../../cmf.html#livestock.components.comp_cmf.CMFSolve.update_case_path">[docs]</a>    <span class="k">def</span> <span class="nf">update_case_path</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Updates the case folder path.&quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">case_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">folder</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\\</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">case_name</span></div>

<div class="viewcode-block" id="CMFSolve.write"><a class="viewcode-back" href="../../../cmf.html#livestock.components.comp_cmf.CMFSolve.write">[docs]</a>    <span class="k">def</span> <span class="nf">write</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">doc</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Writes the needed files.</span>
<span class="sd">        :param doc: Grasshopper document.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Helper functions</span>
        <span class="k">def</span> <span class="nf">write_weather</span><span class="p">(</span><span class="n">weather_dict_</span><span class="p">,</span> <span class="n">folder</span><span class="p">):</span>
            <span class="n">weather_dict</span> <span class="o">=</span> <span class="n">weather_dict_</span><span class="o">.</span><span class="n">c</span>
            <span class="n">weather_root</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">Element</span><span class="p">(</span><span class="s1">&#39;weather&#39;</span><span class="p">)</span>
            <span class="n">weather_keys</span> <span class="o">=</span> <span class="n">weather_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>

            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">weather_keys</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">weather_root</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">))</span>
                <span class="n">data</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">weather_dict</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)])</span>

            <span class="n">weather_tree</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">ElementTree</span><span class="p">(</span><span class="n">weather_root</span><span class="p">)</span>
            <span class="n">weather_file</span> <span class="o">=</span> <span class="s1">&#39;weather.xml&#39;</span>
            <span class="n">weather_tree</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">folder</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="n">weather_file</span><span class="p">,</span> <span class="n">xml_declaration</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">weather_file</span>

        <span class="k">def</span> <span class="nf">write_ground</span><span class="p">(</span><span class="n">ground_dict_</span><span class="p">,</span> <span class="n">folder</span><span class="p">):</span>
            <span class="c1"># Process ground</span>
            <span class="n">ground_dict</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">ground</span><span class="o">.</span><span class="n">c</span> <span class="k">for</span> <span class="n">ground</span> <span class="ow">in</span> <span class="n">ground_dict_</span><span class="p">)</span>
            <span class="n">ground_root</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">Element</span><span class="p">(</span><span class="s1">&#39;ground&#39;</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">ground_dict</span><span class="p">)):</span>
                <span class="n">ground</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">ground_root</span><span class="p">,</span> <span class="s1">&#39;ground_</span><span class="si">%i</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">i</span><span class="p">)</span>
                <span class="n">g_keys</span> <span class="o">=</span> <span class="n">ground_dict</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>

                <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">g_keys</span><span class="p">:</span>
                    <span class="n">data</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">ground</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">g</span><span class="p">))</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">data_to_write</span> <span class="o">=</span> <span class="n">ground_dict</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="nb">str</span><span class="p">(</span><span class="n">g</span><span class="p">)]</span><span class="o">.</span><span class="n">c</span>
                        <span class="n">data</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">data_to_write</span><span class="p">))</span>
                    <span class="k">except</span><span class="p">:</span>
                        <span class="n">data</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">ground_dict</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="nb">str</span><span class="p">(</span><span class="n">g</span><span class="p">)])</span>

            <span class="n">ground_tree</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">ElementTree</span><span class="p">(</span><span class="n">ground_root</span><span class="p">)</span>
            <span class="n">ground_file</span> <span class="o">=</span> <span class="s1">&#39;ground.xml&#39;</span>
            <span class="n">ground_tree</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">folder</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="n">ground_file</span><span class="p">,</span> <span class="n">xml_declaration</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">ground_file</span>

        <span class="k">def</span> <span class="nf">write_trees</span><span class="p">(</span><span class="n">tree_dict_</span><span class="p">,</span> <span class="n">folder</span><span class="p">):</span>
            <span class="c1"># Process trees</span>

            <span class="n">tree_dict</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">c</span> <span class="k">for</span> <span class="n">tree</span> <span class="ow">in</span> <span class="n">tree_dict_</span><span class="p">)</span>
            <span class="n">tree_root</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">Element</span><span class="p">(</span><span class="s1">&#39;tree&#39;</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">tree_dict</span><span class="p">)):</span>
                <span class="n">tree</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">tree_root</span><span class="p">,</span> <span class="s1">&#39;tree_</span><span class="si">%i</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">i</span><span class="p">)</span>
                <span class="n">t_keys</span> <span class="o">=</span> <span class="n">tree_dict</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>

                <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">t_keys</span><span class="p">:</span>
                    <span class="n">data</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">tree</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
                    <span class="n">data_to_write</span> <span class="o">=</span> <span class="n">tree_dict</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="nb">str</span><span class="p">(</span><span class="n">t</span><span class="p">)]</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data_to_write</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                        <span class="n">data</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">data_to_write</span><span class="p">))</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">data</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">data_to_write</span><span class="p">)</span>

            <span class="n">tree_tree</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">ElementTree</span><span class="p">(</span><span class="n">tree_root</span><span class="p">)</span>
            <span class="n">tree_file</span> <span class="o">=</span> <span class="s1">&#39;trees.xml&#39;</span>
            <span class="n">tree_tree</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">folder</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="n">tree_file</span><span class="p">,</span> <span class="n">xml_declaration</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">tree_file</span>

        <span class="k">def</span> <span class="nf">write_outputs</span><span class="p">(</span><span class="n">output_dict_</span><span class="p">,</span> <span class="n">folder</span><span class="p">):</span>
            <span class="c1"># Process outputs</span>
            <span class="n">output_dict</span> <span class="o">=</span> <span class="n">output_dict_</span><span class="o">.</span><span class="n">c</span>
            <span class="n">output_root</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">Element</span><span class="p">(</span><span class="s1">&#39;output&#39;</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">out_key</span> <span class="ow">in</span> <span class="n">output_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">output_root</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">out_key</span><span class="p">))</span>
                <span class="n">data</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">output_dict</span><span class="p">[</span><span class="n">out_key</span><span class="p">])</span>

            <span class="n">output_tree</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">ElementTree</span><span class="p">(</span><span class="n">output_root</span><span class="p">)</span>
            <span class="n">output_file</span> <span class="o">=</span> <span class="s1">&#39;outputs.xml&#39;</span>
            <span class="n">output_tree</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">folder</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="n">output_file</span><span class="p">,</span> <span class="n">xml_declaration</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">output_file</span>

        <span class="k">def</span> <span class="nf">write_stream</span><span class="p">(</span><span class="n">stream_dict_</span><span class="p">,</span> <span class="n">folder</span><span class="p">):</span>
            <span class="k">pass</span>

        <span class="k">def</span> <span class="nf">write_boundary_conditions</span><span class="p">(</span><span class="n">boundary_dict_</span><span class="p">,</span> <span class="n">folder</span><span class="p">):</span>
            <span class="c1"># Process boundary conditions</span>
            <span class="n">boundary_conditions_dict</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">bc</span><span class="o">.</span><span class="n">c</span>
                                            <span class="k">for</span> <span class="n">bc</span> <span class="ow">in</span> <span class="n">boundary_dict_</span><span class="p">)</span>

            <span class="n">boundary_conditions_root</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">Element</span><span class="p">(</span><span class="s1">&#39;boundary_conditions&#39;</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">boundary_conditions_dict</span><span class="p">)):</span>
                <span class="n">boundary_condition</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">boundary_conditions_root</span><span class="p">,</span> <span class="s1">&#39;boundary_condition_</span><span class="si">%i</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">i</span><span class="p">)</span>

                <span class="n">bc_type</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">boundary_condition</span><span class="p">,</span> <span class="s1">&#39;type&#39;</span><span class="p">)</span>
                <span class="n">bc_type</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">boundary_conditions_dict</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;type&#39;</span><span class="p">])</span>

                <span class="n">bc_cell</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">boundary_condition</span><span class="p">,</span> <span class="s1">&#39;cell&#39;</span><span class="p">)</span>
                <span class="n">bc_cell</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">boundary_conditions_dict</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;cell&#39;</span><span class="p">])</span>

                <span class="n">bc_layer</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">boundary_condition</span><span class="p">,</span> <span class="s1">&#39;layer&#39;</span><span class="p">)</span>
                <span class="n">bc_layer</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">boundary_conditions_dict</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;layer&#39;</span><span class="p">])</span>

                <span class="k">if</span> <span class="n">boundary_conditions_dict</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;inlet&#39;</span><span class="p">:</span>
                    <span class="n">bc_flux</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">boundary_condition</span><span class="p">,</span> <span class="s1">&#39;inlet_flux&#39;</span><span class="p">)</span>
                    <span class="n">bc_flux</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">boundary_conditions_dict</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;inlet_flux&#39;</span><span class="p">])</span>

                    <span class="n">bc_step</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">boundary_condition</span><span class="p">,</span> <span class="s1">&#39;time_step&#39;</span><span class="p">)</span>
                    <span class="n">bc_step</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">boundary_conditions_dict</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;time_step&#39;</span><span class="p">])</span>

                <span class="k">elif</span> <span class="n">boundary_conditions_dict</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;outlet&#39;</span><span class="p">:</span>
                    <span class="n">bc_flux</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">boundary_condition</span><span class="p">,</span> <span class="s1">&#39;outlet_type&#39;</span><span class="p">)</span>

                    <span class="n">outlet_connection</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">bc_flux</span><span class="p">,</span> <span class="s1">&#39;outlet_connection&#39;</span><span class="p">)</span>
                    <span class="n">outlet_connection</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">boundary_conditions_dict</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;outlet_type&#39;</span><span class="p">][</span><span class="s1">&#39;connection&#39;</span><span class="p">])</span>

                    <span class="n">outlet_parameter</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">bc_flux</span><span class="p">,</span> <span class="s1">&#39;connection_parameter&#39;</span><span class="p">)</span>
                    <span class="n">outlet_parameter</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">boundary_conditions_dict</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;outlet_type&#39;</span><span class="p">][</span><span class="s1">&#39;connection_parameter&#39;</span><span class="p">])</span>

                    <span class="n">bc_flux</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">boundary_condition</span><span class="p">,</span> <span class="s1">&#39;location&#39;</span><span class="p">)</span>
                    <span class="n">bc_flux</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">boundary_conditions_dict</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;location&#39;</span><span class="p">])</span>

            <span class="n">boundary_conditions_tree</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">ElementTree</span><span class="p">(</span><span class="n">boundary_conditions_root</span><span class="p">)</span>
            <span class="n">boundary_condition_file</span> <span class="o">=</span> <span class="s1">&#39;boundary_condition.xml&#39;</span>
            <span class="n">boundary_conditions_tree</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">folder</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="n">boundary_condition_file</span><span class="p">,</span> <span class="n">xml_declaration</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">boundary_condition_file</span>

        <span class="k">def</span> <span class="nf">write_solver_info</span><span class="p">(</span><span class="n">solver_dict_</span><span class="p">,</span> <span class="n">folder</span><span class="p">):</span>
            <span class="c1"># Process solver info</span>
            <span class="n">solver_root</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">Element</span><span class="p">(</span><span class="s1">&#39;solver&#39;</span><span class="p">)</span>
            <span class="n">solver_dict</span> <span class="o">=</span> <span class="n">solver_dict_</span><span class="o">.</span><span class="n">c</span>

            <span class="k">for</span> <span class="n">solver_key</span> <span class="ow">in</span> <span class="n">solver_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">solver_root</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">solver_key</span><span class="p">))</span>
                <span class="n">data</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">solver_dict</span><span class="p">[</span><span class="n">solver_key</span><span class="p">])</span>

            <span class="n">solver_tree</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">ElementTree</span><span class="p">(</span><span class="n">solver_root</span><span class="p">)</span>
            <span class="n">solver_file</span> <span class="o">=</span> <span class="s1">&#39;solver.xml&#39;</span>
            <span class="n">solver_tree</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">folder</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="n">solver_file</span><span class="p">,</span> <span class="n">xml_declaration</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">solver_file</span>

        <span class="k">def</span> <span class="nf">write_ssh_files</span><span class="p">(</span><span class="n">files_written_</span><span class="p">):</span>
            <span class="c1"># Clean SSH folder</span>
            <span class="n">ssh</span><span class="o">.</span><span class="n">clean_ssh_folder</span><span class="p">()</span>

            <span class="c1"># SSH commands</span>
            <span class="n">ssh_command</span> <span class="o">=</span> <span class="n">ssh</span><span class="o">.</span><span class="n">get_ssh</span><span class="p">()</span>

            <span class="n">file_transfer</span> <span class="o">=</span> <span class="n">files_written_</span>
            <span class="n">file_run</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;cmf_template.py&#39;</span><span class="p">]</span>
            <span class="n">file_return</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;results.xml&#39;</span><span class="p">]</span>

            <span class="n">ssh_command</span><span class="p">[</span><span class="s1">&#39;file_transfer&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">file_transfer</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;,cmf_template.py&#39;</span>
            <span class="n">ssh_command</span><span class="p">[</span><span class="s1">&#39;file_run&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">file_run</span><span class="p">)</span>
            <span class="n">ssh_command</span><span class="p">[</span><span class="s1">&#39;file_return&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">file_return</span><span class="p">)</span>
            <span class="n">ssh_command</span><span class="p">[</span><span class="s1">&#39;template&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;cmf&#39;</span>

            <span class="n">ssh</span><span class="o">.</span><span class="n">write_ssh_commands</span><span class="p">(</span><span class="n">ssh_command</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">ssh_command</span>

        <span class="c1"># check if folder exists</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">case_path</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">written</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">folder</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">case_name</span><span class="p">)</span>

        <span class="n">files_written</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># Save Mesh</span>
        <span class="n">gh_geo</span><span class="o">.</span><span class="n">bake_export_delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mesh</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">case_path</span><span class="p">,</span> <span class="s1">&#39;mesh&#39;</span><span class="p">,</span> <span class="s1">&#39;.obj&#39;</span><span class="p">,</span> <span class="n">doc</span><span class="p">)</span>

        <span class="c1"># Append to files written</span>
        <span class="n">files_written</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;mesh.obj&#39;</span><span class="p">)</span>
        <span class="n">files_written</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">write_weather</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">weather</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">case_path</span><span class="p">))</span>
        <span class="n">files_written</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">write_ground</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ground</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">case_path</span><span class="p">))</span>
        <span class="n">files_written</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">write_outputs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">output_config</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">case_path</span><span class="p">))</span>
        <span class="n">files_written</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">write_solver_info</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">solver_settings</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">case_path</span><span class="p">))</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">trees</span><span class="p">:</span>
            <span class="n">files_written</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">write_trees</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">trees</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">case_path</span><span class="p">))</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">boundary_conditions</span><span class="p">:</span>
            <span class="n">files_written</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">write_boundary_conditions</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">boundary_conditions</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">case_path</span><span class="p">))</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">stream</span><span class="p">:</span>
            <span class="n">files_written</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">write_stream</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stream</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">case_path</span><span class="p">))</span>

        <span class="c1"># template</span>
        <span class="n">pick_template</span><span class="p">(</span><span class="s1">&#39;cmf&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">case_path</span><span class="p">)</span>

        <span class="c1"># ssh</span>
        <span class="n">ssh_cmd</span> <span class="o">=</span> <span class="n">write_ssh_files</span><span class="p">(</span><span class="n">files_written</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">written</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="n">transfer_files</span> <span class="o">=</span> <span class="n">ssh_cmd</span><span class="p">[</span><span class="s1">&#39;file_transfer&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>

        <span class="c1"># Copy files from case folder to ssh folder</span>
        <span class="k">for</span> <span class="n">file_</span> <span class="ow">in</span> <span class="n">transfer_files</span><span class="p">:</span>
            <span class="n">copyfile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">case_path</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="n">file_</span><span class="p">,</span> <span class="n">ssh</span><span class="o">.</span><span class="n">ssh_path</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="n">file_</span><span class="p">)</span>

        <span class="k">return</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="CMFSolve.do_case"><a class="viewcode-back" href="../../../cmf.html#livestock.components.comp_cmf.CMFSolve.do_case">[docs]</a>    <span class="k">def</span> <span class="nf">do_case</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Spawns a new subprocess, that runs the ssh template.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">ssh_template</span> <span class="o">=</span> <span class="n">ssh</span><span class="o">.</span><span class="n">ssh_path</span> <span class="o">+</span> <span class="s1">&#39;/ssh_template.py&#39;</span>

        <span class="c1"># Run template</span>
        <span class="n">thread</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">py_exe</span><span class="p">,</span> <span class="n">ssh_template</span><span class="p">])</span>
        <span class="n">thread</span><span class="o">.</span><span class="n">wait</span><span class="p">()</span>
        <span class="n">thread</span><span class="o">.</span><span class="n">kill</span><span class="p">()</span>

        <span class="k">return</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="CMFSolve.check_results"><a class="viewcode-back" href="../../../cmf.html#livestock.components.comp_cmf.CMFSolve.check_results">[docs]</a>    <span class="k">def</span> <span class="nf">check_results</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Checks if the result files exists and then copies them form the ssh folder to the case folder.</span>
<span class="sd">        If not then a warning is raised.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">ssh_result</span> <span class="o">=</span> <span class="n">ssh</span><span class="o">.</span><span class="n">ssh_path</span> <span class="o">+</span> <span class="s1">&#39;/results.xml&#39;</span>
        <span class="n">result_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">case_path</span> <span class="o">+</span> <span class="s1">&#39;/results.xml&#39;</span>

        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">ssh_result</span><span class="p">):</span>
            <span class="n">copyfile</span><span class="p">(</span><span class="n">ssh_result</span><span class="p">,</span> <span class="n">result_path</span><span class="p">)</span>
            <span class="n">ssh</span><span class="o">.</span><span class="n">clean_ssh_folder</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">result_path</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">warning</span> <span class="o">=</span> <span class="s1">&#39;Could not find result file. Unknown error occurred&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_warning</span><span class="p">(</span><span class="n">warning</span><span class="p">)</span></div>

<div class="viewcode-block" id="CMFSolve.run"><a class="viewcode-back" href="../../../cmf.html#livestock.components.comp_cmf.CMFSolve.run">[docs]</a>    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">doc</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        In case all the checks have passed and write_case is True the component writes the case files.</span>
<span class="sd">        If all checks have passed and run_case is True the simulation is started.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">checks</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">write_case</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">checks</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">run_case</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">do_case</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_results</span><span class="p">()</span></div></div>


<div class="viewcode-block" id="CMFResults"><a class="viewcode-back" href="../../../cmf.html#livestock.components.comp_cmf.CMFResults">[docs]</a><span class="k">class</span> <span class="nc">CMFResults</span><span class="p">(</span><span class="n">GHComponent</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ghenv</span><span class="p">):</span>
        <span class="n">GHComponent</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ghenv</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">inputs</span><span class="p">():</span>
            <span class="k">return</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;ResultFolder&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;Path to result folder. Accepts output from Livestock Solve&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;access&#39;</span><span class="p">:</span> <span class="s1">&#39;item&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;default_value&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">},</span>
                    <span class="mi">1</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;FetchResult&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;Choose which result should be loaded:&#39;</span>
                                       <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">0 - Evapotranspiration&#39;</span>
                                       <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">1 - Surface water volume&#39;</span>
                                       <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">2 - Surface water flux&#39;</span>
                                       <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">3 - Heat flux&#39;</span>
                                       <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">4 - Aerodynamic resistance&#39;</span>
                                       <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">5 - Soil layer water flux&#39;</span>
                                       <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">6 - Soil layer potential&#39;</span>
                                       <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">7 - Soil layer theta&#39;</span>
                                       <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">8 - Soil layer volume&#39;</span>
                                       <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">9 - Soil layer wetness&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;access&#39;</span><span class="p">:</span> <span class="s1">&#39;item&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;default_value&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">},</span>
                    <span class="mi">2</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;SaveCSV&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;Save the values as a csv file - Default is set to False&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;access&#39;</span><span class="p">:</span> <span class="s1">&#39;item&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;default_value&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">},</span>
                    <span class="mi">3</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Run&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;Run component&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;access&#39;</span><span class="p">:</span> <span class="s1">&#39;item&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;default_value&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">}}</span>

        <span class="k">def</span> <span class="nf">outputs</span><span class="p">():</span>
            <span class="k">return</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;readMe!&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;In case of any errors, it will be shown here.&#39;</span><span class="p">},</span>

                    <span class="mi">1</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Units&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;Shows the units of the results&#39;</span><span class="p">},</span>

                    <span class="mi">2</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Values&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;List with chosen result values&#39;</span><span class="p">},</span>

                    <span class="mi">3</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;CSVPath&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;Path to csv file.&#39;</span><span class="p">}}</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">inputs</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">outputs</span> <span class="o">=</span> <span class="n">outputs</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">component_number</span> <span class="o">=</span> <span class="mi">17</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fetch_result</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">save_csv</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">run_component</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">py_exe</span> <span class="o">=</span> <span class="n">gh_misc</span><span class="o">.</span><span class="n">get_python_exe</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">csv_path</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">checks</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">results</span> <span class="o">=</span> <span class="kc">None</span>

<div class="viewcode-block" id="CMFResults.check_inputs"><a class="viewcode-back" href="../../../cmf.html#livestock.components.comp_cmf.CMFResults.check_inputs">[docs]</a>    <span class="k">def</span> <span class="nf">check_inputs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Checks inputs and raises a warning if an input is not the correct type.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">checks</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">warning</span> <span class="o">=</span> <span class="s1">&#39;Temperature should be a float&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_warning</span><span class="p">(</span><span class="n">warning</span><span class="p">)</span></div>

<div class="viewcode-block" id="CMFResults.config"><a class="viewcode-back" href="../../../cmf.html#livestock.components.comp_cmf.CMFResults.config">[docs]</a>    <span class="k">def</span> <span class="nf">config</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generates the Grasshopper component.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Generate Component</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config_component</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">component_number</span><span class="p">)</span></div>

<div class="viewcode-block" id="CMFResults.run_checks"><a class="viewcode-back" href="../../../cmf.html#livestock.components.comp_cmf.CMFResults.run_checks">[docs]</a>    <span class="k">def</span> <span class="nf">run_checks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">fetch_result</span><span class="p">,</span> <span class="n">save</span><span class="p">,</span> <span class="n">run</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gathers the inputs and checks them.</span>
<span class="sd">        :param path: Result path</span>
<span class="sd">        :param fetch_result: Which result to fetch</span>
<span class="sd">        :param save: Whether to save the csv file or not.</span>
<span class="sd">        :param run: Whether to run the component or not.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Gather data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="o">=</span> <span class="n">path</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fetch_result</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">add_default_value</span><span class="p">(</span><span class="n">fetch_result</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">save_csv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_default_value</span><span class="p">(</span><span class="n">save</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">run_component</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_default_value</span><span class="p">(</span><span class="n">run</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>

        <span class="c1"># Run checks</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">check_inputs</span><span class="p">()</span></div>

<div class="viewcode-block" id="CMFResults.process_xml"><a class="viewcode-back" href="../../../cmf.html#livestock.components.comp_cmf.CMFResults.process_xml">[docs]</a>    <span class="k">def</span> <span class="nf">process_xml</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Processes the xml result file and extracts the wanted information and saves it as a csv file.</span>
<span class="sd">        :return: csv file path.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">possible_results</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;evapotranspiration&#39;</span><span class="p">,</span> <span class="s1">&#39;surface_water_volume&#39;</span><span class="p">,</span> <span class="s1">&#39;surface_water_flux&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;heat_flux&#39;</span><span class="p">,</span> <span class="s1">&#39;aerodynamic_resistance&#39;</span><span class="p">,</span> <span class="s1">&#39;volumetric_flux&#39;</span><span class="p">,</span> <span class="s1">&#39;potential&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;theta&#39;</span><span class="p">,</span> <span class="s1">&#39;volume&#39;</span><span class="p">,</span> <span class="s1">&#39;wetness&#39;</span><span class="p">]</span>

        <span class="c1"># Write lookup file</span>
        <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fetch_result</span> <span class="o">&lt;=</span> <span class="mi">4</span><span class="p">:</span>
            <span class="n">out</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;cell&#39;</span><span class="p">:</span> <span class="n">possible_results</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">fetch_result</span><span class="p">]}</span>
            <span class="n">gh_misc</span><span class="o">.</span><span class="n">write_file</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;result_lookup&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">out</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;layer&#39;</span><span class="p">:</span> <span class="n">possible_results</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">fetch_result</span><span class="p">]}</span>
            <span class="n">gh_misc</span><span class="o">.</span><span class="n">write_file</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;result_lookup&#39;</span><span class="p">)</span>

        <span class="c1"># Write template</span>
        <span class="n">pick_template</span><span class="p">(</span><span class="s1">&#39;cmf_results&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">)</span>

        <span class="c1"># Run template</span>
        <span class="n">thread</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">py_exe</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="o">+</span> <span class="s1">&#39;/cmf_results_template.py&#39;</span><span class="p">])</span>
        <span class="n">thread</span><span class="o">.</span><span class="n">wait</span><span class="p">()</span>
        <span class="n">thread</span><span class="o">.</span><span class="n">kill</span><span class="p">()</span>

        <span class="c1"># Construct csv path</span>
        <span class="n">csv_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">possible_results</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">fetch_result</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;.csv&#39;</span>

        <span class="k">return</span> <span class="n">csv_path</span></div>

<div class="viewcode-block" id="CMFResults.load_result_csv"><a class="viewcode-back" href="../../../cmf.html#livestock.components.comp_cmf.CMFResults.load_result_csv">[docs]</a>    <span class="k">def</span> <span class="nf">load_result_csv</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Loads the csv file containing the wanted results.</span>
<span class="sd">        :param path: Csv file path</span>
<span class="sd">        :return: The results</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="nf">convert_file_to_points</span><span class="p">(</span><span class="n">csv_file</span><span class="p">):</span>
            <span class="n">point_list</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">line_</span> <span class="ow">in</span> <span class="n">csv_file</span><span class="p">:</span>
                <span class="n">point_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">convert_line_to_points</span><span class="p">(</span><span class="n">line_</span><span class="p">))</span>

            <span class="k">return</span> <span class="n">point_list</span>

        <span class="k">def</span> <span class="nf">convert_line_to_points</span><span class="p">(</span><span class="n">line_</span><span class="p">):</span>
            <span class="n">points_</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">line_</span><span class="p">:</span>
                <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="n">element</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
                <span class="n">points_</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rg</span><span class="o">.</span><span class="n">Point3d</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="n">y</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="n">z</span><span class="p">)))</span>

            <span class="k">return</span> <span class="n">points_</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fetch_result</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="c1"># fetch_result 2 contains points</span>
                <span class="n">csv_obj</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">convert_file_to_points</span><span class="p">(</span><span class="n">csv_obj</span><span class="p">)</span>

        <span class="k">elif</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fetch_result</span> <span class="o">&lt;=</span> <span class="mi">4</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">csv</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">fetch_result</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>
            <span class="c1"># fetch 5 contains points</span>
            <span class="n">csv_obj</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
            <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">cell_result</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">csv_obj</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;cell&#39;</span><span class="p">):</span>
                    <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cell_result</span><span class="p">)</span>
                    <span class="n">cell_result</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">cell_result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">convert_line_to_points</span><span class="p">(</span><span class="n">line</span><span class="p">))</span>

            <span class="k">return</span> <span class="n">results</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">csv_obj</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
            <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">cell_result</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">csv_obj</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;cell&#39;</span><span class="p">):</span>
                    <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cell_result</span><span class="p">)</span>
                    <span class="n">cell_result</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">cell_result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">results</span></div>

<div class="viewcode-block" id="CMFResults.delete_files"><a class="viewcode-back" href="../../../cmf.html#livestock.components.comp_cmf.CMFResults.delete_files">[docs]</a>    <span class="k">def</span> <span class="nf">delete_files</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">csv_path</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Delete the helper files.&quot;&quot;&quot;</span>
        <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="o">+</span> <span class="s1">&#39;/cmf_results_template.py&#39;</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="o">+</span> <span class="s1">&#39;/result_lookup.txt&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">save_csv</span><span class="p">:</span>
            <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">csv_path</span><span class="p">)</span></div>

<div class="viewcode-block" id="CMFResults.set_units"><a class="viewcode-back" href="../../../cmf.html#livestock.components.comp_cmf.CMFResults.set_units">[docs]</a>    <span class="k">def</span> <span class="nf">set_units</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Function to organize the output units.&quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fetch_result</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1"># evapotranspiration</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="s1">&#39;m3/day&#39;</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">fetch_result</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="c1"># surface_water_volume</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="s1">&#39;m3&#39;</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">fetch_result</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="c1"># surface_water_flux</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="s1">&#39;m3/day&#39;</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">fetch_result</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="c1"># heat_flux</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="s1">&#39;W/m2&#39;</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">fetch_result</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
            <span class="c1"># aerodynamic_resistance</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="s1">&#39;s/m&#39;</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">fetch_result</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>
            <span class="c1"># volumetric_flux</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="s1">&#39;m3/day&#39;</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">fetch_result</span> <span class="o">==</span> <span class="mi">6</span><span class="p">:</span>
            <span class="c1"># potential</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="s1">&#39;m&#39;</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">fetch_result</span> <span class="o">==</span> <span class="mi">7</span><span class="p">:</span>
            <span class="c1"># theta</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="s1">&#39;m3&#39;</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">fetch_result</span> <span class="o">==</span> <span class="mi">8</span><span class="p">:</span>
            <span class="c1"># volume</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="s1">&#39;m3&#39;</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">fetch_result</span> <span class="o">==</span> <span class="mi">9</span><span class="p">:</span>
            <span class="c1"># wetness</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span></div>

<div class="viewcode-block" id="CMFResults.run"><a class="viewcode-back" href="../../../cmf.html#livestock.components.comp_cmf.CMFResults.run">[docs]</a>    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        In case all the checks have passed and run is True the component runs.</span>
<span class="sd">        Following functions are run:</span>
<span class="sd">        set_units()</span>
<span class="sd">        process_xml()</span>
<span class="sd">        load_result_csv()</span>
<span class="sd">        delete_files()</span>
<span class="sd">        The results are converted into a Grasshopper Tree structure.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">checks</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">run_component</span><span class="p">:</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">set_units</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">csv_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">process_xml</span><span class="p">()</span>
            <span class="n">results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_result_csv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">csv_path</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">delete_files</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">csv_path</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">results</span> <span class="o">=</span> <span class="n">gh_misc</span><span class="o">.</span><span class="n">list_to_tree</span><span class="p">(</span><span class="n">results</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="CMFOutputs"><a class="viewcode-back" href="../../../cmf.html#livestock.components.comp_cmf.CMFOutputs">[docs]</a><span class="k">class</span> <span class="nc">CMFOutputs</span><span class="p">(</span><span class="n">GHComponent</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ghenv</span><span class="p">):</span>
        <span class="n">GHComponent</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ghenv</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">inputs</span><span class="p">():</span>
            <span class="k">return</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Evapotranspiration&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;Cell evaporation - default is set to True&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;access&#39;</span><span class="p">:</span> <span class="s1">&#39;item&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;default_value&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">},</span>

                    <span class="mi">1</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;SurfaceWaterVolume&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;Cell surface water - default is set to False&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;access&#39;</span><span class="p">:</span> <span class="s1">&#39;item&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;default_value&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">},</span>

                    <span class="mi">2</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;SurfaceWaterFlux&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;Cell surface water flux - default is set to False&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;access&#39;</span><span class="p">:</span> <span class="s1">&#39;item&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;default_value&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">},</span>

                    <span class="mi">3</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;HeatFlux&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;Cell surface heat flux - default is set to False&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;access&#39;</span><span class="p">:</span> <span class="s1">&#39;item&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;default_value&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">},</span>

                    <span class="mi">4</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;AerodynamicResistance&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;Cell aerodynamic resistance - default is set to False&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;access&#39;</span><span class="p">:</span> <span class="s1">&#39;item&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;default_value&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">},</span>

                    <span class="mi">5</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;VolumetricFlux&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;Soil layer volumetric flux vectors - default is set to False&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;access&#39;</span><span class="p">:</span> <span class="s1">&#39;item&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;default_value&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">},</span>

                    <span class="mi">6</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Potential&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;Soil layer total potential (Psi_tot = Psi_M + Psi_G - default is set to False&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;access&#39;</span><span class="p">:</span> <span class="s1">&#39;item&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;default_value&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">},</span>

                    <span class="mi">7</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Theta&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;Soil layer volumetric water content of the layer - default is set to False&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;access&#39;</span><span class="p">:</span> <span class="s1">&#39;item&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;default_value&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">},</span>

                    <span class="mi">8</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Volume&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;Soil layer volume of water in the layer - default is set to False&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;access&#39;</span><span class="p">:</span> <span class="s1">&#39;item&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;default_value&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">},</span>

                    <span class="mi">9</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Wetness&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;Soil layer wetness of the soil (V_volume/V_pores) - default is set to False&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;access&#39;</span><span class="p">:</span> <span class="s1">&#39;item&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;default_value&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">}</span>
                    <span class="p">}</span>

        <span class="k">def</span> <span class="nf">outputs</span><span class="p">():</span>
            <span class="k">return</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;readMe!&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;In case of any errors, it will be shown here.&#39;</span><span class="p">},</span>

                    <span class="mi">1</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;ChosenOutputs&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;Shows the chosen outputs&#39;</span><span class="p">},</span>

                    <span class="mi">2</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Outputs&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;Livestock Output Data&#39;</span><span class="p">}</span>

                    <span class="p">}</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">inputs</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">outputs</span> <span class="o">=</span> <span class="n">outputs</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">component_number</span> <span class="o">=</span> <span class="mi">16</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">evapo_trans</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">surface_water_volume</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">surface_water_flux</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">heat_flux</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">aero_res</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">three_d_flux</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">potential</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">theta</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">volume</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wetness</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">checks</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">output_dict</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">results</span> <span class="o">=</span> <span class="kc">None</span>

<div class="viewcode-block" id="CMFOutputs.check_inputs"><a class="viewcode-back" href="../../../cmf.html#livestock.components.comp_cmf.CMFOutputs.check_inputs">[docs]</a>    <span class="k">def</span> <span class="nf">check_inputs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Checks inputs and raises a warning if an input is not the correct type.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">checks</span> <span class="o">=</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="CMFOutputs.config"><a class="viewcode-back" href="../../../cmf.html#livestock.components.comp_cmf.CMFOutputs.config">[docs]</a>    <span class="k">def</span> <span class="nf">config</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generates the Grasshopper component.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Generate Component</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config_component</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">component_number</span><span class="p">)</span></div>

<div class="viewcode-block" id="CMFOutputs.run_checks"><a class="viewcode-back" href="../../../cmf.html#livestock.components.comp_cmf.CMFOutputs.run_checks">[docs]</a>    <span class="k">def</span> <span class="nf">run_checks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">evapo_trans</span><span class="p">,</span> <span class="n">surface_water_volume</span><span class="p">,</span> <span class="n">surface_water_flux</span><span class="p">,</span> <span class="n">heat_flux</span><span class="p">,</span> <span class="n">aero_res</span><span class="p">,</span> <span class="n">three_d_flux</span><span class="p">,</span>
                   <span class="n">potential</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">volume</span><span class="p">,</span> <span class="n">wetness</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gathers the inputs and checks them.</span>
<span class="sd">        :param evapo_trans: Whether to include evapotranspiration or not.</span>
<span class="sd">        :param surface_water_volume: Whether to include surface water volume or not.</span>
<span class="sd">        :param surface_water_flux: Whether to include surface water flux or not.</span>
<span class="sd">        :param heat_flux: Whether to include surface heat flux or not.</span>
<span class="sd">        :param aero_res: Whether to include aerodynamic resistance or not.</span>
<span class="sd">        :param three_d_flux: Whether to include soil water flux or not.</span>
<span class="sd">        :param potential: Whether to include soil potential or not.</span>
<span class="sd">        :param theta: Whether to include soil theta or not.</span>
<span class="sd">        :param volume: Whether to include soil water volume or not.</span>
<span class="sd">        :param wetness: Whether to include soil wetness or not.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Gather data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">evapo_trans</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_default_value</span><span class="p">(</span><span class="n">evapo_trans</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">surface_water_volume</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_default_value</span><span class="p">(</span><span class="n">surface_water_volume</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">surface_water_flux</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_default_value</span><span class="p">(</span><span class="n">surface_water_flux</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">heat_flux</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_default_value</span><span class="p">(</span><span class="n">heat_flux</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">aero_res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_default_value</span><span class="p">(</span><span class="n">aero_res</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">three_d_flux</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_default_value</span><span class="p">(</span><span class="n">three_d_flux</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">potential</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_default_value</span><span class="p">(</span><span class="n">potential</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">theta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_default_value</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">volume</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_default_value</span><span class="p">(</span><span class="n">volume</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wetness</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_default_value</span><span class="p">(</span><span class="n">wetness</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>

        <span class="c1"># Run checks</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">check_inputs</span><span class="p">()</span></div>

<div class="viewcode-block" id="CMFOutputs.set_outputs"><a class="viewcode-back" href="../../../cmf.html#livestock.components.comp_cmf.CMFOutputs.set_outputs">[docs]</a>    <span class="k">def</span> <span class="nf">set_outputs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convertes the wanted outputs into a dict</span>
<span class="sd">        :return: output dict.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">output_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;cell&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;layer&#39;</span><span class="p">:</span> <span class="p">[]}</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">evapo_trans</span><span class="p">:</span>
            <span class="n">output_dict</span><span class="p">[</span><span class="s1">&#39;cell&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;evaporation&#39;</span><span class="p">)</span>
            <span class="n">output_dict</span><span class="p">[</span><span class="s1">&#39;cell&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;transpiration&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">surface_water_volume</span><span class="p">:</span>
            <span class="n">output_dict</span><span class="p">[</span><span class="s1">&#39;cell&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;surface_water_volume&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">surface_water_flux</span><span class="p">:</span>
            <span class="n">output_dict</span><span class="p">[</span><span class="s1">&#39;cell&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;surface_water_flux&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">heat_flux</span><span class="p">:</span>
            <span class="n">output_dict</span><span class="p">[</span><span class="s1">&#39;cell&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;heat_flux&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">aero_res</span><span class="p">:</span>
            <span class="n">output_dict</span><span class="p">[</span><span class="s1">&#39;cell&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;aerodynamic_resistance&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">three_d_flux</span><span class="p">:</span>
            <span class="n">output_dict</span><span class="p">[</span><span class="s1">&#39;layer&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;volumetric_flux&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">potential</span><span class="p">:</span>
            <span class="n">output_dict</span><span class="p">[</span><span class="s1">&#39;layer&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;potential&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">theta</span><span class="p">:</span>
            <span class="n">output_dict</span><span class="p">[</span><span class="s1">&#39;layer&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;theta&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">volume</span><span class="p">:</span>
            <span class="n">output_dict</span><span class="p">[</span><span class="s1">&#39;layer&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;volume&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">wetness</span><span class="p">:</span>
            <span class="n">output_dict</span><span class="p">[</span><span class="s1">&#39;layer&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;wetness&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">output_dict</span></div>

<div class="viewcode-block" id="CMFOutputs.run"><a class="viewcode-back" href="../../../cmf.html#livestock.components.comp_cmf.CMFOutputs.run">[docs]</a>    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        In case all the checks have passed the component runs.</span>
<span class="sd">        set_outputs() are run and passed on with PassClass.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">checks</span><span class="p">:</span>
            <span class="n">out_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_outputs</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">output_dict</span> <span class="o">=</span> <span class="n">out_dict</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">results</span> <span class="o">=</span> <span class="n">gh_misc</span><span class="o">.</span><span class="n">PassClass</span><span class="p">(</span><span class="n">out_dict</span><span class="p">,</span> <span class="s1">&#39;Outputs&#39;</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="CMFInlet"><a class="viewcode-back" href="../../../cmf.html#livestock.components.comp_cmf.CMFInlet">[docs]</a><span class="k">class</span> <span class="nc">CMFInlet</span><span class="p">(</span><span class="n">GHComponent</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ghenv</span><span class="p">):</span>
        <span class="n">GHComponent</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ghenv</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">inputs</span><span class="p">():</span>
            <span class="k">return</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;ConnectedCell&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;Cell to connect to. Default is set to first cell&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;access&#39;</span><span class="p">:</span> <span class="s1">&#39;item&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;default_value&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">},</span>

                    <span class="mi">1</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;ConnectedLayer&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;Layer of cell to connect to. 0 is surface water.</span><span class="se">\n</span><span class="s1">&#39;</span>
                                       <span class="s1">&#39;1 is first layer of cell and so on.</span><span class="se">\n</span><span class="s1">&#39;</span>
                                       <span class="s1">&#39;Default is set to 0 - surface water&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;access&#39;</span><span class="p">:</span> <span class="s1">&#39;item&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;default_value&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">},</span>

                    <span class="mi">2</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;InletFlux&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;If inlet, then set flux in m3/day&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;access&#39;</span><span class="p">:</span> <span class="s1">&#39;list&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;default_value&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">},</span>

                    <span class="mi">3</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;TimeStep&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;Time step between each value in InletFlux. Time step is in hours -&#39;</span>
                                       <span class="s1">&#39; e.g. 1/60 equals time steps of 1 min.</span><span class="se">\n</span><span class="s1">&#39;</span>
                                       <span class="s1">&#39;Default is 1 hour.&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;access&#39;</span><span class="p">:</span> <span class="s1">&#39;item&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;default_value&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>
                    <span class="p">}</span>

        <span class="k">def</span> <span class="nf">outputs</span><span class="p">():</span>
            <span class="k">return</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;readMe!&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;In case of any errors, it will be shown here.&#39;</span><span class="p">},</span>

                    <span class="mi">1</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;BoundaryCondition&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;Livestock Boundary Condition&#39;</span><span class="p">}</span>
                    <span class="p">}</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">inputs</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">outputs</span> <span class="o">=</span> <span class="n">outputs</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;CMF Boundary connection&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">component_number</span> <span class="o">=</span> <span class="mi">23</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cell</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">layer</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inlet_flux</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_step</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">checks</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">results</span> <span class="o">=</span> <span class="kc">None</span>

<div class="viewcode-block" id="CMFInlet.check_inputs"><a class="viewcode-back" href="../../../cmf.html#livestock.components.comp_cmf.CMFInlet.check_inputs">[docs]</a>    <span class="k">def</span> <span class="nf">check_inputs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Checks inputs and raises a warning if an input is not the correct type.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">inlet_flux</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">checks</span> <span class="o">=</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="CMFInlet.config"><a class="viewcode-back" href="../../../cmf.html#livestock.components.comp_cmf.CMFInlet.config">[docs]</a>    <span class="k">def</span> <span class="nf">config</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generates the Grasshopper component.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Generate Component</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config_component</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">component_number</span><span class="p">)</span></div>

<div class="viewcode-block" id="CMFInlet.run_checks"><a class="viewcode-back" href="../../../cmf.html#livestock.components.comp_cmf.CMFInlet.run_checks">[docs]</a>    <span class="k">def</span> <span class="nf">run_checks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cell</span><span class="p">,</span> <span class="n">layer</span><span class="p">,</span> <span class="n">inlet_flux</span><span class="p">,</span> <span class="n">time_step</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gathers the inputs and checks them.</span>

<span class="sd">        :param cell:</span>
<span class="sd">        :param layer:</span>
<span class="sd">        :param inlet_flux:</span>
<span class="sd">        :param time_step:</span>
<span class="sd">        :return:</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Gather data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cell</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_default_value</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">cell</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">layer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_default_value</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">layer</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inlet_flux</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_default_value</span><span class="p">(</span><span class="n">inlet_flux</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_step</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_default_value</span><span class="p">(</span><span class="n">time_step</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>

        <span class="c1"># Run checks</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">check_inputs</span><span class="p">()</span></div>

<div class="viewcode-block" id="CMFInlet.set_inlet"><a class="viewcode-back" href="../../../cmf.html#livestock.components.comp_cmf.CMFInlet.set_inlet">[docs]</a>    <span class="k">def</span> <span class="nf">set_inlet</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Constructs a dict with inlet information.&quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">results</span> <span class="o">=</span> <span class="n">gh_misc</span><span class="o">.</span><span class="n">PassClass</span><span class="p">({</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;inlet&#39;</span><span class="p">,</span>
                                          <span class="s1">&#39;cell&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">cell</span><span class="p">,</span>
                                          <span class="s1">&#39;layer&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">layer</span><span class="p">,</span>
                                          <span class="s1">&#39;inlet_flux&#39;</span><span class="p">:</span> <span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">elem</span><span class="p">)</span>
                                                            <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">inlet_flux</span><span class="p">]),</span>
                                          <span class="s1">&#39;time_step&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_step</span>
                                          <span class="p">},</span>
                                         <span class="s1">&#39;BoundaryCondition&#39;</span><span class="p">)</span>

        <span class="n">pp</span> <span class="o">=</span> <span class="n">pprint</span><span class="o">.</span><span class="n">PrettyPrinter</span><span class="p">(</span><span class="n">indent</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
        <span class="n">pp</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">c</span><span class="p">)</span></div>

<div class="viewcode-block" id="CMFInlet.run"><a class="viewcode-back" href="../../../cmf.html#livestock.components.comp_cmf.CMFInlet.run">[docs]</a>    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        In case all the checks have passed the component runs.</span>
<span class="sd">        It runs set_inlet().</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">checks</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_inlet</span><span class="p">()</span></div></div>


<div class="viewcode-block" id="CMFSolverSettings"><a class="viewcode-back" href="../../../cmf.html#livestock.components.comp_cmf.CMFSolverSettings">[docs]</a><span class="k">class</span> <span class="nc">CMFSolverSettings</span><span class="p">(</span><span class="n">GHComponent</span><span class="p">):</span>

        <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ghenv</span><span class="p">):</span>
            <span class="n">GHComponent</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ghenv</span><span class="p">)</span>

            <span class="k">def</span> <span class="nf">inputs</span><span class="p">():</span>
                <span class="k">return</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;AnalysisLength&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;Total length of the simulation in hours - default is set to 24 hours.&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;access&#39;</span><span class="p">:</span> <span class="s1">&#39;item&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;default_value&#39;</span><span class="p">:</span> <span class="mi">24</span><span class="p">},</span>

                        <span class="mi">1</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;TimeStep&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;Size of each time step in hours - e.g. 1/60 equals time steps of 1 min and&#39;</span>
                                           <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">24 is a time step of one day. &#39;</span>
                                           <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Default is 1 hour&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;access&#39;</span><span class="p">:</span> <span class="s1">&#39;item&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;default_value&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span>

                        <span class="mi">2</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;SolverTolerance&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;Solver tolerance - Default is 1e-8&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;access&#39;</span><span class="p">:</span> <span class="s1">&#39;item&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;default_value&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="o">**-</span><span class="mi">8</span><span class="p">},</span>

                        <span class="mi">3</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Verbosity&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;Sets the verbosity of the print statement during runtime - Default is 1.</span><span class="se">\n</span><span class="s1">&#39;</span>
                                           <span class="s1">&#39;0 - Prints only at start and end of simulation.</span><span class="se">\n</span><span class="s1">&#39;</span>
                                           <span class="s1">&#39;1 - Prints at every time step.&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;access&#39;</span><span class="p">:</span> <span class="s1">&#39;item&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;default_value&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}}</span>

            <span class="k">def</span> <span class="nf">outputs</span><span class="p">():</span>
                <span class="k">return</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;readMe!&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;In case of any errors, it will be shown here.&#39;</span><span class="p">},</span>

                        <span class="mi">1</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;SolverSettings&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;Livestock Solver Settings&#39;</span><span class="p">}}</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">inputs</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">outputs</span> <span class="o">=</span> <span class="n">outputs</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">component_number</span> <span class="o">=</span> <span class="mi">21</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;Sets the solver settings for CMF Solve&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">length</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">time_step</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tolerance</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">verbosity</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">checks</span> <span class="o">=</span> <span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">results</span> <span class="o">=</span> <span class="kc">None</span>

<div class="viewcode-block" id="CMFSolverSettings.check_inputs"><a class="viewcode-back" href="../../../cmf.html#livestock.components.comp_cmf.CMFSolverSettings.check_inputs">[docs]</a>        <span class="k">def</span> <span class="nf">check_inputs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Checks inputs and raises a warning if an input is not the correct type.</span>
<span class="sd">            &quot;&quot;&quot;</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">checks</span> <span class="o">=</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="CMFSolverSettings.config"><a class="viewcode-back" href="../../../cmf.html#livestock.components.comp_cmf.CMFSolverSettings.config">[docs]</a>        <span class="k">def</span> <span class="nf">config</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Generates the Grasshopper component.</span>
<span class="sd">            &quot;&quot;&quot;</span>

            <span class="c1"># Generate Component</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">config_component</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">component_number</span><span class="p">)</span></div>

<div class="viewcode-block" id="CMFSolverSettings.run_checks"><a class="viewcode-back" href="../../../cmf.html#livestock.components.comp_cmf.CMFSolverSettings.run_checks">[docs]</a>        <span class="k">def</span> <span class="nf">run_checks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">length</span><span class="p">,</span> <span class="n">time_step</span><span class="p">,</span> <span class="n">tolerance</span><span class="p">,</span> <span class="n">verbosity</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Gathers the inputs and checks them.</span>
<span class="sd">            :param length: Number of time steps to be taken.</span>
<span class="sd">            :param time_step: Size of time step.</span>
<span class="sd">            :param tolerance: Solver tolerance.</span>
<span class="sd">            :param verbosity: Solver verbosity.</span>
<span class="sd">            &quot;&quot;&quot;</span>

            <span class="c1"># Gather data</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">length</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_default_value</span><span class="p">(</span><span class="n">length</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">time_step</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_default_value</span><span class="p">(</span><span class="n">time_step</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tolerance</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_default_value</span><span class="p">(</span><span class="n">tolerance</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">verbosity</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_default_value</span><span class="p">(</span><span class="n">verbosity</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>

            <span class="c1"># Run checks</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">check_inputs</span><span class="p">()</span></div>

<div class="viewcode-block" id="CMFSolverSettings.run"><a class="viewcode-back" href="../../../cmf.html#livestock.components.comp_cmf.CMFSolverSettings.run">[docs]</a>        <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            In case all the checks have passed the component runs.</span>
<span class="sd">            Constructs a solver settings dict, prints it and passes it on with PassClass.</span>
<span class="sd">            &quot;&quot;&quot;</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">checks</span><span class="p">:</span>
                <span class="n">settings_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;analysis_length&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">length</span><span class="p">),</span>
                                 <span class="s1">&#39;time_step&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">time_step</span><span class="p">),</span>
                                 <span class="s1">&#39;tolerance&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">tolerance</span><span class="p">,</span>
                                 <span class="s1">&#39;verbosity&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">verbosity</span><span class="p">)}</span>

                <span class="nb">print</span><span class="p">(</span><span class="n">settings_dict</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">results</span> <span class="o">=</span> <span class="n">gh_misc</span><span class="o">.</span><span class="n">PassClass</span><span class="p">(</span><span class="n">settings_dict</span><span class="p">,</span> <span class="s1">&#39;SolverSettings&#39;</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="CMFSurfaceFluxResult"><a class="viewcode-back" href="../../../cmf.html#livestock.components.comp_cmf.CMFSurfaceFluxResult">[docs]</a><span class="k">class</span> <span class="nc">CMFSurfaceFluxResult</span><span class="p">(</span><span class="n">GHComponent</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ghenv</span><span class="p">):</span>
        <span class="n">GHComponent</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ghenv</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">inputs</span><span class="p">():</span>
            <span class="k">return</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;ResultFolder&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;Path to result folder. Accepts output from Livestock Solve&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;access&#39;</span><span class="p">:</span> <span class="s1">&#39;item&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;default_value&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">},</span>

                    <span class="mi">1</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Mesh&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;Mesh of the case&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;access&#39;</span><span class="p">:</span> <span class="s1">&#39;item&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;default_value&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">},</span>

                    <span class="mi">2</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;IncludeRunOff&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;Include surface run-off into the surface flux vector? &#39;</span>
                                       <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Default is set to True&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;access&#39;</span><span class="p">:</span> <span class="s1">&#39;item&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;default_value&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">},</span>

                    <span class="mi">3</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;IncludeRain&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;Include rain into the surface flux vector?&#39;</span>
                                       <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Default is False.&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;access&#39;</span><span class="p">:</span> <span class="s1">&#39;item&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;default_value&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">},</span>

                    <span class="mi">4</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;IncludeEvapotranspiration&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;Include evapotranspiration into the surface flux vector? &#39;</span>
                                       <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Default is set to False&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;access&#39;</span><span class="p">:</span> <span class="s1">&#39;item&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;default_value&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">},</span>

                    <span class="mi">5</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;IncludeInfiltration&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;Include infiltration into the surface flux vector? &#39;</span>
                                       <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Default is set to False&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;access&#39;</span><span class="p">:</span> <span class="s1">&#39;item&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;default_value&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">},</span>

                    <span class="mi">6</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;SaveResult&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;Save the values as a text file - Default is set to False&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;access&#39;</span><span class="p">:</span> <span class="s1">&#39;item&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;default_value&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">},</span>

                    <span class="mi">7</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Write&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;Write component files&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;access&#39;</span><span class="p">:</span> <span class="s1">&#39;item&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;default_value&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">},</span>

                    <span class="mi">8</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Run&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;Run component&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;access&#39;</span><span class="p">:</span> <span class="s1">&#39;item&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;default_value&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">}}</span>

        <span class="k">def</span> <span class="nf">outputs</span><span class="p">():</span>
            <span class="k">return</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;readMe!&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;In case of any errors, it will be shown here.&#39;</span><span class="p">},</span>

                    <span class="mi">1</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Unit&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;Shows the units of the results&#39;</span><span class="p">},</span>

                    <span class="mi">2</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;SurfaceFluxVectors&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;Tree with the surface flux vectors&#39;</span><span class="p">},</span>

                    <span class="mi">3</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;CSVPath&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;Path to csv file.&#39;</span><span class="p">}}</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">inputs</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">outputs</span> <span class="o">=</span> <span class="n">outputs</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">component_number</span> <span class="o">=</span> <span class="mi">25</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="s1">&#39;m3/day&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mesh</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">run_off</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rain</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">evapo</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">infiltration</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">save_result</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write_files</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">run_component</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">py_exe</span> <span class="o">=</span> <span class="n">gh_misc</span><span class="o">.</span><span class="n">get_python_exe</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">checks</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">results</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">result_path</span> <span class="o">=</span> <span class="kc">None</span>

<div class="viewcode-block" id="CMFSurfaceFluxResult.check_inputs"><a class="viewcode-back" href="../../../cmf.html#livestock.components.comp_cmf.CMFSurfaceFluxResult.check_inputs">[docs]</a>    <span class="k">def</span> <span class="nf">check_inputs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Checks inputs and raises a warning if an input is not the correct type.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">checks</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">warning</span> <span class="o">=</span> <span class="s1">&#39;Insert result path&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_warning</span><span class="p">(</span><span class="n">warning</span><span class="p">)</span></div>

<div class="viewcode-block" id="CMFSurfaceFluxResult.config"><a class="viewcode-back" href="../../../cmf.html#livestock.components.comp_cmf.CMFSurfaceFluxResult.config">[docs]</a>    <span class="k">def</span> <span class="nf">config</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generates the Grasshopper component.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Generate Component</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config_component</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">component_number</span><span class="p">)</span></div>

<div class="viewcode-block" id="CMFSurfaceFluxResult.run_checks"><a class="viewcode-back" href="../../../cmf.html#livestock.components.comp_cmf.CMFSurfaceFluxResult.run_checks">[docs]</a>    <span class="k">def</span> <span class="nf">run_checks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">mesh</span><span class="p">,</span> <span class="n">run_off</span><span class="p">,</span> <span class="n">rain</span><span class="p">,</span> <span class="n">evapo</span><span class="p">,</span> <span class="n">infiltration</span><span class="p">,</span> <span class="n">save</span><span class="p">,</span> <span class="n">write</span><span class="p">,</span> <span class="n">run</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gathers the inputs and checks them.</span>
<span class="sd">        :param path: Path for result file.</span>
<span class="sd">        :param mesh: Case mesh</span>
<span class="sd">        :param run_off: Whether to include run-off or not.</span>
<span class="sd">        :param rain: Whether to include rain or not.</span>
<span class="sd">        :param evapo: Whether to include evapotranspiration or not.</span>
<span class="sd">        :param infiltration: Whether to include infiltration or not.</span>
<span class="sd">        :param save: Save result to file or not</span>
<span class="sd">        :param write: Write component files or not</span>
<span class="sd">        :param run: Run component or not.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Gather data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="o">=</span> <span class="n">path</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mesh</span> <span class="o">=</span> <span class="n">mesh</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">run_off</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_default_value</span><span class="p">(</span><span class="n">run_off</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rain</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_default_value</span><span class="p">(</span><span class="n">rain</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">evapo</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_default_value</span><span class="p">(</span><span class="n">evapo</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">infiltration</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_default_value</span><span class="p">(</span><span class="n">infiltration</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">save_result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_default_value</span><span class="p">(</span><span class="n">save</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write_files</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_default_value</span><span class="p">(</span><span class="n">write</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">run_component</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_default_value</span><span class="p">(</span><span class="n">run</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">result_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="o">+</span> <span class="s1">&#39;/surface_flux_result.txt&#39;</span>

        <span class="c1"># Run checks</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">check_inputs</span><span class="p">()</span></div>

<div class="viewcode-block" id="CMFSurfaceFluxResult.run_template"><a class="viewcode-back" href="../../../cmf.html#livestock.components.comp_cmf.CMFSurfaceFluxResult.run_template">[docs]</a>    <span class="k">def</span> <span class="nf">run_template</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Spawns a subprocess that runs the template.&quot;&quot;&quot;</span>

        <span class="c1"># Run template</span>
        <span class="n">thread</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">py_exe</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="o">+</span> <span class="s1">&#39;/cmf_surface_results_template.py&#39;</span><span class="p">])</span>
        <span class="n">thread</span><span class="o">.</span><span class="n">wait</span><span class="p">()</span>
        <span class="n">thread</span><span class="o">.</span><span class="n">kill</span><span class="p">()</span></div>

<div class="viewcode-block" id="CMFSurfaceFluxResult.write"><a class="viewcode-back" href="../../../cmf.html#livestock.components.comp_cmf.CMFSurfaceFluxResult.write">[docs]</a>    <span class="k">def</span> <span class="nf">write</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Writes the wanted information from the mesh and the flux configurations.&quot;&quot;&quot;</span>

        <span class="c1"># helper functions</span>
        <span class="k">def</span> <span class="nf">process_mesh</span><span class="p">(</span><span class="n">mesh_</span><span class="p">,</span> <span class="n">path_</span><span class="p">):</span>
            <span class="n">points</span> <span class="o">=</span> <span class="n">rs</span><span class="o">.</span><span class="n">MeshFaceCenters</span><span class="p">(</span><span class="n">mesh_</span><span class="p">)</span>

            <span class="n">point_obj</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">path_</span> <span class="o">+</span> <span class="s1">&#39;/center_points.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">point</span> <span class="ow">in</span> <span class="n">points</span><span class="p">:</span>
                <span class="n">point_obj</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">element</span><span class="p">)</span>
                                         <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">point</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
                                <span class="p">)</span>

            <span class="n">point_obj</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

            <span class="k">return</span> <span class="kc">True</span>

        <span class="k">def</span> <span class="nf">flux_config</span><span class="p">(</span><span class="n">path_</span><span class="p">,</span> <span class="n">run_off</span><span class="p">,</span> <span class="n">rain</span><span class="p">,</span> <span class="n">evapo</span><span class="p">,</span> <span class="n">infiltration</span><span class="p">):</span>

            <span class="n">flux_obj</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">path_</span> <span class="o">+</span> <span class="s1">&#39;/flux_config.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
            <span class="n">flux_obj</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">run_off</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">flux_obj</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">rain</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">flux_obj</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">evapo</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">flux_obj</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">infiltration</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">flux_obj</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

            <span class="k">return</span> <span class="kc">True</span>

        <span class="n">process_mesh</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mesh</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">)</span>
        <span class="n">flux_config</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">run_off</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rain</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">evapo</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">infiltration</span><span class="p">)</span>
        <span class="c1"># Write template</span>
        <span class="n">pick_template</span><span class="p">(</span><span class="s1">&#39;cmf_surface_results&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">)</span>

        <span class="k">return</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="CMFSurfaceFluxResult.load_result"><a class="viewcode-back" href="../../../cmf.html#livestock.components.comp_cmf.CMFSurfaceFluxResult.load_result">[docs]</a>    <span class="k">def</span> <span class="nf">load_result</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Loads the results.&quot;&quot;&quot;</span>

        <span class="c1"># Helper functions</span>
        <span class="k">def</span> <span class="nf">convert_file_to_points</span><span class="p">(</span><span class="n">file_lines</span><span class="p">):</span>
            <span class="n">point_list</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">line_</span> <span class="ow">in</span> <span class="n">file_lines</span><span class="p">:</span>
                <span class="n">point_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">convert_line_to_points</span><span class="p">(</span><span class="n">line_</span><span class="o">.</span><span class="n">strip</span><span class="p">()))</span>

            <span class="k">return</span> <span class="n">point_list</span>

        <span class="k">def</span> <span class="nf">convert_line_to_points</span><span class="p">(</span><span class="n">line_</span><span class="p">):</span>
            <span class="n">points_</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">line_</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">):</span>
                <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="n">element</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
                <span class="n">points_</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rg</span><span class="o">.</span><span class="n">Point3d</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="n">y</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="n">z</span><span class="p">)))</span>

            <span class="k">return</span> <span class="n">points_</span>

        <span class="n">result_obj</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">result_path</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
        <span class="n">result_lines</span> <span class="o">=</span> <span class="n">result_obj</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
        <span class="n">results</span> <span class="o">=</span> <span class="n">convert_file_to_points</span><span class="p">(</span><span class="n">result_lines</span><span class="p">)</span>
        <span class="n">result_obj</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">results</span></div>

<div class="viewcode-block" id="CMFSurfaceFluxResult.delete_files"><a class="viewcode-back" href="../../../cmf.html#livestock.components.comp_cmf.CMFSurfaceFluxResult.delete_files">[docs]</a>    <span class="k">def</span> <span class="nf">delete_files</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Deletes the helper files.&quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="o">+</span> <span class="s1">&#39;/flux_config.txt&#39;</span><span class="p">):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="o">+</span> <span class="s1">&#39;/flux_config.txt&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="o">+</span> <span class="s1">&#39;/center_points.txt&#39;</span><span class="p">):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="o">+</span> <span class="s1">&#39;/center_points.txt&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="o">+</span> <span class="s1">&#39;/cmf_surface_results_template.py&#39;</span><span class="p">):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="o">+</span> <span class="s1">&#39;/cmf_surface_results_template.py&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">save_result</span><span class="p">:</span>
            <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">result_path</span><span class="p">)</span></div>

<div class="viewcode-block" id="CMFSurfaceFluxResult.run"><a class="viewcode-back" href="../../../cmf.html#livestock.components.comp_cmf.CMFSurfaceFluxResult.run">[docs]</a>    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        In case all the checks have passed and Write is True the component writes the component files.</span>
<span class="sd">        In case all the checks have passed the component runs.</span>
<span class="sd">        The following functions are run:</span>
<span class="sd">        write()</span>
<span class="sd">        run_template()</span>
<span class="sd">        load_results()</span>
<span class="sd">        delete_files()</span>
<span class="sd">        The results are converted into a Grasshopper Tree structure.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">checks</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">write_files</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">checks</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">run_component</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">run_template</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">results</span> <span class="o">=</span> <span class="n">gh_misc</span><span class="o">.</span><span class="n">list_to_tree</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">load_result</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">delete_files</span><span class="p">()</span></div></div>


<div class="viewcode-block" id="CMFOutlet"><a class="viewcode-back" href="../../../cmf.html#livestock.components.comp_cmf.CMFOutlet">[docs]</a><span class="k">class</span> <span class="nc">CMFOutlet</span><span class="p">(</span><span class="n">GHComponent</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ghenv</span><span class="p">):</span>
        <span class="n">GHComponent</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ghenv</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">inputs</span><span class="p">():</span>
            <span class="k">return</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Location&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;Location of the outlet in x, y and z coordinates.</span><span class="se">\n</span><span class="s1">&#39;</span>
                                       <span class="s1">&#39;Default is 0,0,0&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;access&#39;</span><span class="p">:</span> <span class="s1">&#39;item&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;default_value&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]},</span>

                    <span class="mi">1</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;ConnectedCell&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;Cell to connect to.</span><span class="se">\n</span><span class="s1">&#39;</span>
                                       <span class="s1">&#39;Default is set to first cell&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;access&#39;</span><span class="p">:</span> <span class="s1">&#39;item&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;default_value&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">},</span>

                    <span class="mi">2</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;ConnectedLayer&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;Layer of cell to connect to.</span><span class="se">\n</span><span class="s1">&#39;</span>
                                       <span class="s1">&#39;0 is surface water.</span><span class="se">\n</span><span class="s1">&#39;</span>
                                       <span class="s1">&#39;1 is first layer of cell and so on.</span><span class="se">\n</span><span class="s1">&#39;</span>
                                       <span class="s1">&#39;Default is set to 0 - surface water&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;access&#39;</span><span class="p">:</span> <span class="s1">&#39;item&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;default_value&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">},</span>

                    <span class="mi">3</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;OutletType&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;Set type of outlet connection.</span><span class="se">\n</span><span class="s1">&#39;</span>
                                        <span class="s1">&#39;1 - Richards.</span><span class="se">\n</span><span class="s1">&#39;</span>
                                        <span class="s1">&#39;2 - Kinematic wave.</span><span class="se">\n</span><span class="s1">&#39;</span>
                                        <span class="s1">&#39;3 - Technical Flux.&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;access&#39;</span><span class="p">:</span> <span class="s1">&#39;item&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;default_value&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">},</span>

                   <span class="mi">4</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;ConnectionParameter&#39;</span><span class="p">,</span>
                       <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;If Richards:</span><span class="se">\n</span><span class="s1">&#39;</span>
                                      <span class="s1">&#39;    Potential - Sets the potential of the outlet. The difference in potential&#39;</span>
                                      <span class="s1">&#39; is what drives the flux.</span><span class="se">\n</span><span class="s1">&#39;</span>
                                      <span class="s1">&#39;If Kinematic wave:</span><span class="se">\n</span><span class="s1">&#39;</span>
                                      <span class="s1">&#39;    Residence Time - Linear flow parameter of travel time in days.</span><span class="se">\n</span><span class="s1">&#39;</span>
                                      <span class="s1">&#39;If Technical Flux:</span><span class="se">\n</span><span class="s1">&#39;</span>
                                      <span class="s1">&#39;    Maximum Flux - The maximum flux is in m3/day.&#39;</span><span class="p">,</span>
                       <span class="s1">&#39;access&#39;</span><span class="p">:</span> <span class="s1">&#39;item&#39;</span><span class="p">,</span>
                       <span class="s1">&#39;default_value&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">}</span>

                    <span class="p">}</span>

        <span class="k">def</span> <span class="nf">outputs</span><span class="p">():</span>
            <span class="k">return</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;readMe!&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;In case of any errors, it will be shown here.&#39;</span><span class="p">},</span>

                    <span class="mi">1</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;BoundaryCondition&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;Livestock Boundary Condition&#39;</span><span class="p">}</span>
                    <span class="p">}</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">inputs</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">outputs</span> <span class="o">=</span> <span class="n">outputs</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;CMF Outlet&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">component_number</span> <span class="o">=</span> <span class="mi">29</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">location</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cell</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">layer</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">outlet_type</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parameter</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">checks</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">results</span> <span class="o">=</span> <span class="kc">None</span>

<div class="viewcode-block" id="CMFOutlet.check_inputs"><a class="viewcode-back" href="../../../cmf.html#livestock.components.comp_cmf.CMFOutlet.check_inputs">[docs]</a>    <span class="k">def</span> <span class="nf">check_inputs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Checks inputs and raises a warning if an input is not the correct type.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">outlet_type</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameter</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">checks</span> <span class="o">=</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="CMFOutlet.config"><a class="viewcode-back" href="../../../cmf.html#livestock.components.comp_cmf.CMFOutlet.config">[docs]</a>    <span class="k">def</span> <span class="nf">config</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generates the Grasshopper component.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Generate Component</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config_component</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">component_number</span><span class="p">)</span></div>

<div class="viewcode-block" id="CMFOutlet.run_checks"><a class="viewcode-back" href="../../../cmf.html#livestock.components.comp_cmf.CMFOutlet.run_checks">[docs]</a>    <span class="k">def</span> <span class="nf">run_checks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">location</span><span class="p">,</span> <span class="n">cell</span><span class="p">,</span> <span class="n">layer</span><span class="p">,</span> <span class="n">type_</span><span class="p">,</span> <span class="n">type_parameter</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gathers the inputs and checks them.</span>

<span class="sd">        :param location: Location of the cell</span>
<span class="sd">        :param cell: Cell to connect to. Default is set to first cell</span>
<span class="sd">        :param layer: Layer of cell to connect to. 0 is surface water.</span>
<span class="sd">        :param type_: Type of connection from CMF Outlet Type</span>
<span class="sd">        :param type_parameter: Parameter for the connection type.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Gather data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">location</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_default_value</span><span class="p">(</span><span class="n">location</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cell</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_default_value</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">cell</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">layer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_default_value</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">layer</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">outlet_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_default_value</span><span class="p">(</span><span class="n">type_</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parameter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_default_value</span><span class="p">(</span><span class="n">type_parameter</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>

        <span class="c1"># Run checks</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">check_inputs</span><span class="p">()</span></div>

<div class="viewcode-block" id="CMFOutlet.location_to_string"><a class="viewcode-back" href="../../../cmf.html#livestock.components.comp_cmf.CMFOutlet.location_to_string">[docs]</a>    <span class="k">def</span> <span class="nf">location_to_string</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Converts the location to a string.</span>

<span class="sd">        :return: The location as a comma separated string</span>
<span class="sd">        :rtype: str</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">location</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">location</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">location_string</span> <span class="o">=</span> <span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
                                        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">location</span><span class="p">])</span>
            <span class="k">return</span> <span class="n">location_string</span></div>

<div class="viewcode-block" id="CMFOutlet.type_to_connection"><a class="viewcode-back" href="../../../cmf.html#livestock.components.comp_cmf.CMFOutlet.type_to_connection">[docs]</a>    <span class="k">def</span> <span class="nf">type_to_connection</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">outlet_type</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;richards&#39;</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">outlet_type</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;kinematic_wave&#39;</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">outlet_type</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;technical_flux&#39;</span></div>

<div class="viewcode-block" id="CMFOutlet.set_outlet_connection"><a class="viewcode-back" href="../../../cmf.html#livestock.components.comp_cmf.CMFOutlet.set_outlet_connection">[docs]</a>    <span class="k">def</span> <span class="nf">set_outlet_connection</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Constructs a dict with outlet information.&quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;connection&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">type_to_connection</span><span class="p">(),</span>
                <span class="s1">&#39;connection_parameter&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameter</span><span class="p">}</span></div>

<div class="viewcode-block" id="CMFOutlet.set_outlet"><a class="viewcode-back" href="../../../cmf.html#livestock.components.comp_cmf.CMFOutlet.set_outlet">[docs]</a>    <span class="k">def</span> <span class="nf">set_outlet</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Constructs a dict with outlet information.&quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">results</span> <span class="o">=</span> <span class="n">gh_misc</span><span class="o">.</span><span class="n">PassClass</span><span class="p">({</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;outlet&#39;</span><span class="p">,</span>
                                          <span class="s1">&#39;location&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">location_to_string</span><span class="p">(),</span>
                                          <span class="s1">&#39;cell&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">cell</span><span class="p">,</span>
                                          <span class="s1">&#39;layer&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">layer</span><span class="p">,</span>
                                          <span class="s1">&#39;outlet_type&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_outlet_connection</span><span class="p">(),</span>
                                          <span class="p">},</span>
                                         <span class="s1">&#39;BoundaryCondition&#39;</span><span class="p">)</span>

        <span class="n">pp</span> <span class="o">=</span> <span class="n">pprint</span><span class="o">.</span><span class="n">PrettyPrinter</span><span class="p">(</span><span class="n">indent</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
        <span class="n">pp</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">c</span><span class="p">)</span></div>

<div class="viewcode-block" id="CMFOutlet.run"><a class="viewcode-back" href="../../../cmf.html#livestock.components.comp_cmf.CMFOutlet.run">[docs]</a>    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        In case all the checks have passed the component runs.</span>
<span class="sd">        It runs set_outlet().</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">checks</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_outlet</span><span class="p">()</span></div></div>


</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../../index.html">Documentation overview</a><ul>
  <li><a href="../../index.html">Module code</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2017, Christian Kongsgaard Nielsen.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.6.5</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.10</a>
      
    </div>

    

    
  </body>
</html>